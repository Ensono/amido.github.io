(window.webpackJsonp=window.webpackJsonp||[]).push([[55,92,131],{140:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return u})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return m}));var a=n(2),r=n(6),i=(n(0),n(223)),o=(n(225),n(230)),s=n(231),c=n(51),l=n(53),u={id:"getting_started_ssr",title:"Getting Started",sidebar_label:"Getting Started",hide_title:!1,hide_table_of_contents:!1,description:"Getting started with SSR",keywords:["rest","api","ssr","cms","integration","framework","configuration","side","rendering","server","server side rendering"]},b={unversionedId:"workloads/azure/frontend/SSR/getting_started_ssr",id:"workloads/azure/frontend/SSR/getting_started_ssr",isDocsHomePage:!1,title:"Getting Started",description:"Getting started with SSR",source:"@site/docs/workloads/azure/frontend/SSR/getting_started_ssr.md",slug:"/workloads/azure/frontend/SSR/getting_started_ssr",permalink:"/docs/workloads/azure/frontend/SSR/getting_started_ssr",version:"current",sidebar_label:"Getting Started",sidebar:"docs",previous:{title:"State Management",permalink:"/docs/workloads/azure/frontend/SSR/state_management_ssr"},next:{title:"Contentful Integration",permalink:"/docs/workloads/azure/frontend/SSR/contentful_integration"}},p=[{value:"Bootstrap your framework",id:"bootstrap-your-framework",children:[{value:"Get developing in just a few questions",id:"get-developing-in-just-a-few-questions",children:[]}]},{value:"Environment Variables",id:"environment-variables",children:[]},{value:"Configure Optional Features",id:"configure-optional-features",children:[]},{value:"Get developing",id:"get-developing",children:[{value:"Development",id:"development",children:[]},{value:"Production",id:"production",children:[]}]},{value:"Implementation details",id:"implementation-details",children:[]},{value:"To build and run using Docker",id:"to-build-and-run-using-docker",children:[{value:"Dockerfile Notes",id:"dockerfile-notes",children:[]}]},{value:"Testing",id:"testing",children:[{value:"Unit, Component and Snapshot Testing",id:"unit-component-and-snapshot-testing",children:[]},{value:"Visual Testing",id:"visual-testing",children:[]},{value:"Accessibility Testing",id:"accessibility-testing",children:[]},{value:"Static Testing",id:"static-testing",children:[]},{value:"Consumer driven contract testing with Pact",id:"consumer-driven-contract-testing-with-pact",children:[]}]},{value:"Customizing",id:"customizing",children:[]},{value:"Feedback",id:"feedback",children:[]}],d={rightToc:p};function m(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Web applications require a lot of boilerplate. It's also hard to know how to get started without examples. We offer both server side rendered (SSR) and client side rendered (CSR) solutions that can be bootstrapped and tailored to your current project with just one command."),Object(i.b)("p",null,"Oh, and they come complete with infrastructure as code so you can deploy on your cloud of choice."),Object(i.b)("p",null,"Brilliant."),Object(i.b)(l.default,{url:"https://vimeo.com/486755394",mdxType:"ResponsivePlayer"}),Object(i.b)("h2",{id:"bootstrap-your-framework"},"Bootstrap your framework"),Object(i.b)("p",null,"The best way to get started, is bootstrap the framework using the scaffolding-cli from Amido Stacks. By using it in interactive mode, you can simply answered 5 questions to get a bespoke framework, ready to go with an example test."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash",metastring:'title="Run to start configuring your solution"',title:'"Run',to:!0,start:!0,configuring:!0,your:!0,'solution"':!0}),"npx @amidostacks/scaffolding-cli run -i\n")),Object(i.b)("h3",{id:"get-developing-in-just-a-few-questions"},"Get developing in just a few questions"),Object(i.b)("h2",{id:"environment-variables"},"Environment Variables"),Object(i.b)("p",null,"Before you can start developing you will need to replace your environment variables with the appropriated values.\nThis values will be automatically picked up and used by the underlying server and web client."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),' NODE_ENV=development\n PORT=3000\n APP_BASE_URL=http://localhost\n APP_BASE_PATH=""\n')),Object(i.b)(o.a,{defaultValue:"linux",values:[{label:"Linux/MacOS",value:"linux"},{label:"Windows",value:"windows"}],mdxType:"Tabs"},Object(i.b)(s.a,{value:"windows",mdxType:"TabItem"},Object(i.b)("div",null,Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"set NODE_ENV=development\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"set PORT=3000\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"set APP_BASE_URL=http://localhost\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'set APP_BASE_PATH=""\n')))),Object(i.b)(s.a,{value:"linux",mdxType:"TabItem"},Object(i.b)("div",null,Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"export NODE_ENV=development\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"export PORT=3000\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"export APP_BASE_URL=http://localhost\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'export APP_BASE_PATH=""\n'))))),Object(i.b)("h2",{id:"configure-optional-features"},"Configure Optional Features"),Object(i.b)("p",null,Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/workloads/azure/frontend/SSR/identity"}),"Auth0")," ",Object(i.b)("br",null),"\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/workloads/azure/frontend/SSR/contentful_integration"}),"Contentful")," ",Object(i.b)("br",null),"\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/workloads/azure/frontend/SSR/api_definition_ssr"}),"API")," ",Object(i.b)("br",null)),Object(i.b)("h2",{id:"get-developing"},"Get developing"),Object(i.b)("p",null,"Install dependencies (this may take a while, please be patient):"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"npm install\n")),Object(i.b)("p",null,"Compile the app:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"npm run build\n")),Object(i.b)("p",null,"At the end of bootstrapping your example framework, you will have an output that will contain all the:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"dependencies"),Object(i.b)("li",{parentName:"ul"},"scripts"),Object(i.b)("li",{parentName:"ul"},"example tests"),Object(i.b)("li",{parentName:"ul"},"pipelines"),Object(i.b)("li",{parentName:"ul"},"and information to start testing")),Object(i.b)("h3",{id:"development"},"Development"),Object(i.b)("p",null,"If you like to view the github repository , the source code can be found ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/amido/stacks-typescript-ssr"}),"here"),"\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/amido/stacks-webapp-template/tree/master/packages/scaffolding-cli/templates/src/ssr"}),"https://github.com/amido/stacks-webapp-template/tree/master/packages/scaffolding-cli/templates/src/ssr")),Object(i.b)("p",null,"Move to the ",Object(i.b)("inlineCode",{parentName:"p"},"<PROJECT-NAME>/src")," folder and run the next commands"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"npm install\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"npm run dev\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash",metastring:'title="To run locally"',title:'"To',run:!0,'locally"':!0}),"npm run start\n")),Object(i.b)("p",null,"This offers live reload of both server side - ",Object(i.b)("em",{parentName:"p"},"when using ssr")," - and client side code."),Object(i.b)("h3",{id:"production"},"Production"),Object(i.b)("p",null,"Move to the ",Object(i.b)("inlineCode",{parentName:"p"},"<PROJECT-NAME>/src")," folder and run the next commands"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"npm install\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"npm run build\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"npm run start\n")),Object(i.b)("p",null,"This will start the app in production mode, so you can see how it would behave deployed!"),Object(i.b)("h2",{id:"implementation-details"},"Implementation details"),Object(i.b)("p",null,"The template is a Server Side Rendered (SSR) implementation using:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://reactjs.org/"}),"React.js")," for the user interface (UI)"),Object(i.b)("li",{parentName:"ul"},"React SSR framework ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://nextjs.org/"}),"Next.js")),Object(i.b)("li",{parentName:"ul"},"Nextjs using a\n",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://nextjs.org/docs/advanced-features/custom-server"}),"Custom Server")," with\nNode.js ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://expressjs.com/"}),"Express.js"))),Object(i.b)("h2",{id:"to-build-and-run-using-docker"},"To build and run using Docker"),Object(i.b)("p",null,"  In order to be able to build and run the webapp template, across environments\nand as part of CI, we need to use ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.docker.com/install/"}),"Docker"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash",metastring:'title="Build from the webapp directory"',title:'"Build',from:!0,the:!0,webapp:!0,'directory"':!0}),"docker build ../ -f ./Dockerfile -t stacks-app\n")),Object(i.b)("p",null,"  Run it:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker run --rm -it -p 3000:3000 stacks-app\ndocker run --rm -it -v $(pwd):/app/deployed/src stacks-app:latest /bin/sh\ndocker run --rm -it -v $(pwd):/usr/src sonarsource/sonar-scanner-cli\ndocker run --rm -it -p 3000:3000 stacks-app:latest /bin/sh\n")),Object(i.b)("p",null,"  Alternatives to running in a container"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'CMD ["pm2-runtime", "--json", "./ecosystem.yml", "--exp-backoff-restart-delay=500", "-a", "--update-env"]\n')),Object(i.b)("h3",{id:"dockerfile-notes"},"Dockerfile Notes"),Object(i.b)("p",null,"  Best practice guidelines:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Do not run app under root",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"To maximise cache layer capacity we should copy over package.json into /tmp\nand build there")))),Object(i.b)("h2",{id:"testing"},"Testing"),Object(i.b)("h3",{id:"unit-component-and-snapshot-testing"},"Unit, Component and Snapshot Testing"),Object(i.b)("p",null,"  We are using ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://jestjs.io/"}),"Jest")," for running all unit, component,\nintegration and snapshot tests. Jest supports TypeScript via Babel. Because\nTypeScript support in Babel is transpilation, to ensure that Jest will\ntype-check the tests as they are run we use\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/kulshekhar/ts-jest"}),"ts-jest"),"."),Object(i.b)("p",null,"  To help that encourage good testing practices for React DOM testing, we are\nleveraging a helper library ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://jestjs.io/"}),"react-testing-library"),"."),Object(i.b)("p",null,"  ",Object(i.b)("inlineCode",{parentName:"p"},"npm run test"),": To run all unit tests. This will also run any snapshot tests.\nSnapshots are to be checked in and are found under the source code.\n",Object(i.b)("inlineCode",{parentName:"p"},"__tests__/__snapshots__")),Object(i.b)("p",null,"For more information using Cypress, see:\n","[Testing and Quality]",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://stacks.amido.com/docs/testing/cypress_functional_testing"}),"https://stacks.amido.com/docs/testing/cypress_functional_testing"),")."),Object(i.b)("h3",{id:"visual-testing"},"Visual Testing"),Object(i.b)("p",null,"For more information using Applitools with Cypress, see:\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://stacks.amido.com/docs/testing/visual_analysis"}),"Testing and Quality"),"."),Object(i.b)("h3",{id:"accessibility-testing"},"Accessibility Testing"),Object(i.b)("p",null,"For more information using Axe with Jest and Cypress, see:\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://stacks.amido.com/docs/testing/accessibility_testing"}),"Testing and Quality"),"."),Object(i.b)("h3",{id:"static-testing"},"Static Testing"),Object(i.b)("p",null,"For more information about the running using amidostacks/ci-sonarscanner, please\nrefer to:\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://hub.docker.com/repository/docker/amidostacks/ci-sonarscanner"}),"amidostacks/ci-sonarscanner")),Object(i.b)("p",null,"For general information about setting up and using SonarQube for static\nanalysis, please refer to the\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/amido/stacks-webapp-template/tree/master/docstest_static_code.md"}),"docs/test_static_code")),Object(i.b)("h3",{id:"consumer-driven-contract-testing-with-pact"},"Consumer driven contract testing with Pact"),Object(i.b)("p",null,"Please refer to the very verbose documentation in\n",Object(i.b)("inlineCode",{parentName:"p"},"/__tests__/pact/README.md")),Object(i.b)("h2",{id:"customizing"},"Customizing"),Object(i.b)("p",null,"Since the frameworks provide real examples on deployed applications, we recommend using these as examples and then replacing them with your own applications under test."),Object(i.b)("h2",{id:"feedback"},"Feedback"),Object(i.b)("p",null,"As always, we only improve from the incredible feedback and contributions from people like you. To help us improve, see our contribution guide for more information."),Object(i.b)(c.default,{prev:!0,mdxType:"HideNavigation"}))}m.isMDXComponent=!0},223:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),u=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},b=function(e){var t=u(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),b=u(n),d=a,m=b["".concat(o,".").concat(d)]||b[d]||p[d]||i;return n?r.a.createElement(m,s(s({ref:t},l),{},{components:n})):r.a.createElement(m,s({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},224:function(e,t,n){"use strict";var a=n(0),r=n(19);t.a=function(){var e=Object(a.useContext)(r.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},225:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(224),r=n(227);function i(){var e=Object(a.a)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,a){var i=void 0===a?{}:a,o=i.forcePrependBaseUrl,s=void 0!==o&&o,c=i.absolute,l=void 0!==c&&c;if(!n)return n;if(n.startsWith("#"))return n;if(Object(r.b)(n))return n;if(s)return t+n;var u=n.startsWith(t)?n:t+n.replace(/^\//,"");return l?e+u:u}(i,n,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},226:function(e,t,n){"use strict";function a(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}},227:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!a(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},228:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)(void 0);t.a=r},229:function(e,t,n){"use strict";var a=n(0),r=n(228);t.a=function(){var e=Object(a.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},230:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(229),o=n(226),s=n(52),c=n.n(s),l=37,u=39;t.a=function(e){var t=e.block,n=e.children,s=e.defaultValue,b=e.values,p=e.groupId,d=Object(i.a)(),m=d.tabGroupChoices,f=d.setTabGroupChoices,O=Object(a.useState)(s),j=O[0],h=O[1],g=Object(a.useState)(!1),v=g[0],y=g[1];if(null!=p){var w=m[p];null!=w&&w!==j&&b.some((function(e){return e.value===w}))&&h(w)}var N=function(e){h(e),null!=p&&f(p,e)},k=[],_=function(e){e.metaKey||e.altKey||e.ctrlKey||y(!0)},S=function(){y(!1)};return Object(a.useEffect)((function(){window.addEventListener("keydown",_),window.addEventListener("mousedown",S)}),[]),r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(o.a)("tabs",{"tabs--block":t})},b.map((function(e){var t=e.value,n=e.label;return r.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":j===t,className:Object(o.a)("tabs__item",c.a.tabItem,{"tabs__item--active":j===t}),style:v?{}:{outline:"none"},key:t,ref:function(e){return k.push(e)},onKeyDown:function(e){!function(e,t,n){switch(n.keyCode){case u:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case l:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(k,e.target,e),_(e)},onFocus:function(){return N(t)},onClick:function(){N(t),y(!1)},onPointerDown:function(){return y(!1)}},n)}))),r.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(n).filter((function(e){return e.props.value===j}))[0]))}},231:function(e,t,n){"use strict";var a=n(0),r=n.n(a);t.a=function(e){return r.a.createElement("div",null,e.children)}},51:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a);t.default=function(e){var t=e.next,n=e.prev;return r.a.useEffect((function(){if(t){var e=document.querySelector("div.pagination-nav__item.pagination-nav__item--next>a");e&&e.style&&(e.style.display="none")}if(n){var a=document.querySelector("div.pagination-nav__item>a");a&&a.style&&(a.style.display="none")}})),r.a.createElement("div",null)}},53:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(234),o=n.n(i),s=n(54),c=n.n(s);t.default=function(e){var t=e.url;return r.a.createElement("div",{className:c.a.playerSection},r.a.createElement("div",{className:c.a.playerWrapper},r.a.createElement(o.a,{className:c.a.player,url:t,controls:!0,width:"100%",height:"100%",config:{}})))}}}]);