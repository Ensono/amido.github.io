"use strict";(self.webpackChunkstacks=self.webpackChunkstacks||[]).push([[5613],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=a.createContext({}),u=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(o.Provider,{value:t},e.children)},p="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),d=i,h=p["".concat(o,".").concat(d)]||p[d]||g[d]||r;return n?a.createElement(h,s(s({ref:t},c),{},{components:n})):a.createElement(h,s({ref:t},c))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,s=new Array(r);s[0]=d;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[p]="string"==typeof e?e:i,s[1]=l;for(var u=2;u<r;u++)s[u]=n[u];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5162:function(e,t,n){n.d(t,{Z:function(){return s}});var a=n(7294),i=n(6010),r={tabItem:"tabItem_Ymn6"};function s(e){var t=e.children,n=e.hidden,s=e.className;return a.createElement("div",{role:"tabpanel",className:(0,i.Z)(r.tabItem,s),hidden:n},t)}},4866:function(e,t,n){n.d(t,{Z:function(){return x}});var a=n(7462),i=n(7294),r=n(6010),s=n(2466),l=n(6550),o=n(1980),u=n(7392),c=n(12);function p(e){return function(e){var t,n;return null!=(t=null==(n=i.Children.map(e,(function(e){if(!e||(0,i.isValidElement)(e)&&(t=e.props)&&"object"==typeof t&&"value"in t)return e;var t;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:n.filter(Boolean))?t:[]}(e).map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes,default:t.default}}))}function g(e){var t=e.values,n=e.children;return(0,i.useMemo)((function(){var e=null!=t?t:p(n);return function(e){var t=(0,u.l)(e,(function(e,t){return e.value===t.value}));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function d(e){var t=e.value;return e.tabValues.some((function(e){return e.value===t}))}function h(e){var t=e.queryString,n=void 0!==t&&t,a=e.groupId,r=(0,l.k6)(),s=function(e){var t=e.queryString,n=void 0!==t&&t,a=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:n,groupId:a});return[(0,o._X)(s),(0,i.useCallback)((function(e){if(s){var t=new URLSearchParams(r.location.search);t.set(s,e),r.replace(Object.assign({},r.location,{search:t.toString()}))}}),[s,r])]}function y(e){var t,n,a,r,s=e.defaultValue,l=e.queryString,o=void 0!==l&&l,u=e.groupId,p=g(e),y=(0,i.useState)((function(){return function(e){var t,n=e.defaultValue,a=e.tabValues;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!d({value:n,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+a.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var i=null!=(t=a.find((function(e){return e.default})))?t:a[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:s,tabValues:p})})),m=y[0],f=y[1],b=h({queryString:o,groupId:u}),v=b[0],w=b[1],x=(t=function(e){return e?"docusaurus.tab."+e:null}({groupId:u}.groupId),n=(0,c.Nk)(t),a=n[0],r=n[1],[a,(0,i.useCallback)((function(e){t&&r.set(e)}),[t,r])]),k=x[0],A=x[1],_=function(){var e=null!=v?v:k;return d({value:e,tabValues:p})?e:null}();return(0,i.useLayoutEffect)((function(){_&&f(_)}),[_]),{selectedValue:m,selectValue:(0,i.useCallback)((function(e){if(!d({value:e,tabValues:p}))throw new Error("Can't select invalid tab value="+e);f(e),w(e),A(e)}),[w,A,p]),tabValues:p}}var m=n(2389),f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function b(e){var t=e.className,n=e.block,l=e.selectedValue,o=e.selectValue,u=e.tabValues,c=[],p=(0,s.o5)().blockElementScrollPositionUntilNextRender,g=function(e){var t=e.currentTarget,n=c.indexOf(t),a=u[n].value;a!==l&&(p(t),o(a))},d=function(e){var t,n=null;switch(e.key){case"Enter":g(e);break;case"ArrowRight":var a,i=c.indexOf(e.currentTarget)+1;n=null!=(a=c[i])?a:c[0];break;case"ArrowLeft":var r,s=c.indexOf(e.currentTarget)-1;n=null!=(r=c[s])?r:c[c.length-1]}null==(t=n)||t.focus()};return i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},t)},u.map((function(e){var t=e.value,n=e.label,s=e.attributes;return i.createElement("li",(0,a.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:function(e){return c.push(e)},onKeyDown:d,onClick:g},s,{className:(0,r.Z)("tabs__item",f.tabItem,null==s?void 0:s.className,{"tabs__item--active":l===t})}),null!=n?n:t)})))}function v(e){var t=e.lazy,n=e.children,a=e.selectedValue,r=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){var s=r.find((function(e){return e.props.value===a}));return s?(0,i.cloneElement)(s,{className:"margin-top--md"}):null}return i.createElement("div",{className:"margin-top--md"},r.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==a})})))}function w(e){var t=y(e);return i.createElement("div",{className:(0,r.Z)("tabs-container",f.tabList)},i.createElement(b,(0,a.Z)({},e,t)),i.createElement(v,(0,a.Z)({},e,t)))}function x(e){var t=(0,m.Z)();return i.createElement(w,(0,a.Z)({key:String(t)},e))}},6893:function(e,t,n){n.r(t),n.d(t,{assets:function(){return g},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return u},metadata:function(){return p},toc:function(){return d}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),s=n(4866),l=n(5162),o=["components"],u={id:"playwright_accessibility_testing",title:"Accessibility Testing with Playwright",sidebar_label:"Accessibility Testing",description:"Accessibility Testing with Playwright using Axe!",keywords:["NX","axe","tests","testing","playwright","accessibility testing"]},c=void 0,p={unversionedId:"testing/testing_in_nx/playwright_accessibility_testing",id:"testing/testing_in_nx/playwright_accessibility_testing",title:"Accessibility Testing with Playwright",description:"Accessibility Testing with Playwright using Axe!",source:"@site/docs/testing/testing_in_nx/playwright_accessibility_testing.md",sourceDirName:"testing/testing_in_nx",slug:"/testing/testing_in_nx/playwright_accessibility_testing",permalink:"/docs/testing/testing_in_nx/playwright_accessibility_testing",draft:!1,tags:[],version:"current",frontMatter:{id:"playwright_accessibility_testing",title:"Accessibility Testing with Playwright",sidebar_label:"Accessibility Testing",description:"Accessibility Testing with Playwright using Axe!",keywords:["NX","axe","tests","testing","playwright","accessibility testing"]},sidebar:"docs",previous:{title:"Testing with playwright",permalink:"/docs/testing/testing_in_nx/testing_with_playwright"},next:{title:"Playwright with Visual Comparisons",permalink:"/docs/testing/testing_in_nx/playwright_visual_testing"}},g={},d=[{value:"Axe: Accessibility testing",id:"axe-accessibility-testing",level:2},{value:"Scaffolded Example",id:"scaffolded-example",level:3},{value:"Running your accessibility tests",id:"running-your-accessibility-tests",level:3},{value:"Viewing your test results",id:"viewing-your-test-results",level:2}],h={toc:d},y="wrapper";function m(e){var t=e.components,n=(0,i.Z)(e,o);return(0,r.kt)(y,(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Accessibility testing with Playwright is very simple and ensures that everyone, including those with disabilities or impairments can fully access and use the site or app. It is not only a legal requirement, but also a moral and ethical one, to ensure that digital products are inclusive and usable by all."),(0,r.kt)("h2",{id:"axe-accessibility-testing"},"Axe: Accessibility testing"),(0,r.kt)("p",null,"From the Dequeue family of products, we are using ",(0,r.kt)("a",{parentName:"p",href:"https://www.deque.com/axe/"},"aXe")," for accessibility testing, specifically their Node.js plugin, ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dequelabs/axe-core-npm/blob/develop/packages/playwright/README.md"},(0,r.kt)("inlineCode",{parentName:"a"},"@axe-core/playwright")),", for integration into the Playwright testing framework."),(0,r.kt)("h3",{id:"scaffolded-example"},"Scaffolded Example"),(0,r.kt)("p",null,"When accessibility tests are scaffolded into your project you will see the following example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="axe-accessibility.spec.ts"',title:'"axe-accessibility.spec.ts"'},"import { test, expect } from '@playwright/test';\nimport AxeBuilder from '@axe-core/playwright';\nimport { prettyPrintAxeReport } from 'axe-result-pretty-print';\n\ntest.describe('NextJs example accessibility tests @accessibility', () => {\n  \n  test('should not have any automatically detectable WCAG A or AA violations', async ({\n    page,\n  }) => {\n    await page.goto('/');\n    await new AxeBuilder({ page })\n      .withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa'])\n      .analyze()\n      .then((results) => {\n        prettyPrintAxeReport({\n          violations: results.violations,\n          passes: results.passes,\n        });\n        expect(results.violations,'No violations should be present, see console log').toHaveLength(0)\n      });\n  });\n});\n")),(0,r.kt)("p",null,"Using the AxeBuilder, a chainable API for playwright, we automatically inject axe into all frames. Using the optional ",(0,r.kt)("inlineCode",{parentName:"p"},"withTags()")," function we can specify the WCAG guidelines we want to verify our application conforms to. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"// highlight-next-line\nawait new AxeBuilder({ page }).withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa']).analyze()\n      .then((results) => {\n        prettyPrintAxeReport({\n          violations: results.violations,\n          passes: results.passes,\n        });\n        expect(results.violations,'No violations should be present, see console log').toHaveLength(0)\n      });\n")),(0,r.kt)("p",null,"Upon axe analysis we then pass the results object to the ",(0,r.kt)("inlineCode",{parentName:"p"},"then()")," function. In here we use the axe-result-pretty-print to view the accessibility test results in a readable format."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"await new AxeBuilder({ page }).withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa']).analyze()\n      .then((results) => {\n        // highlight-start\n        prettyPrintAxeReport({\n          violations: results.violations,\n          passes: results.passes,\n        });\n        // highlight-end\n        expect(results.violations,'No violations should be present, see console log').toHaveLength(0)\n      });\n")),(0,r.kt)("p",null,"The violations array within the results object detail any elements of the application which have breached the specified/default web content accessibility guidelines. As such, we assert that there are no entries in the array, if there are more than one elements then the test will fail."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"await new AxeBuilder({ page }).withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa']).analyze()\n      .then((results) => {\n        // highlight-start\n        prettyPrintAxeReport({\n          violations: results.violations,\n          passes: results.passes,\n        });\n        // highlight-next-line\n        expect(results.violations,'No violations should be present, see console log').toHaveLength(0)\n      });\n")),(0,r.kt)("h3",{id:"running-your-accessibility-tests"},"Running your accessibility tests"),(0,r.kt)("p",null,"We recommend tagging your Playwright accessibility tests so that you can target these specific tests if required. In the below examples we have tagged the tests with ",(0,r.kt)("strong",{parentName:"p"},"@accessibility")," which enables us to target them through ",(0,r.kt)("strong",{parentName:"p"},"grep")," as seen in the ",(0,r.kt)("a",{parentName:"p",href:"/docs/testing/testing_in_nx/testing_with_playwright#run-specific-tests"},"'Run specific tests'")," example"),(0,r.kt)(s.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"grouped",label:"Grouped",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"//multiple tests grouped in a describe block\ntest.describe('Example test group @accessibility', () => {\n           \n   test('accessibility test 1', async ({ page }) => {\n       //test code\n   });\n\n   test('accessibility test 2', async ({ page }) => {\n       //test code\n   });\n}\n"))),(0,r.kt)(l.Z,{value:"individual",label:"Individual",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"test('Example individual test @accessibility', async ({ page }) => {\n   //Accessibility test with AxeBuilder\n});\n")))),(0,r.kt)("h2",{id:"viewing-your-test-results"},"Viewing your test results"),(0,r.kt)("p",null,"Further to the explanation given in the ",(0,r.kt)("a",{parentName:"p",href:"/docs/testing/testing_in_nx/testing_with_playwright#running-your-playwright-tests"},"'Testing with Playwright'")," page, accessibility test results can also be found in the console output post execution."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text",metastring:'title="Sample AXE report"',title:'"Sample',AXE:!0,'report"':!0},"\nPage passed 16 axe rules: aria-allowed-attr, aria-hidden-body, aria-required-attr, aria-roles, aria-valid-attr-value, aria-valid-attr, avoid-inline-spacing, bypass, color-contrast, document-title, duplicate-id-active, duplicate-id, link-name, meta-viewport, nested-interactive, svg-img-alt\nAxe core library found 3 violations\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 (index) \u2502                                                description                                                \u2502        id        \u2502        wcag         \u2502  impact   \u2502 nodes \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502    0    \u2502 'Ensures the contrast between foreground and background colors meets WCAG 2 AA contrast ratio thresholds' \u2502 'color-contrast' \u2502 'WCAG 2.0 Level AA' \u2502 'serious' \u2502   1   \u2502\n\u2502    1    \u2502                            'Ensures every HTML document has a lang attribute'                             \u2502 'html-has-lang'  \u2502 'WCAG 2.0 Level A'  \u2502 'serious' \u2502   1   \u2502\n\u2502    2    \u2502  'Ensures <svg> elements with an img, graphics-document or graphics-symbol role have an accessible text'  \u2502  'svg-img-alt'   \u2502 'WCAG 2.0 Level A'  \u2502 'serious' \u2502   1   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n1. id: 'color-contrast' learn more: https://dequeuniversity.com/rules/axe/4.6/color-contrast?application=playwright\n   name: Elements must have sufficient color contrast\n   description: Ensures the contrast between foreground and background colors meets WCAG 2 AA contrast ratio thresholds\n   WCAG: 'WCAG 2.0 Level AA'\n   Affected elements:\n        Selector: \"#love\"Source code: <p id=\"love\">\n\n2. id: 'html-has-lang' learn more: https://dequeuniversity.com/rules/axe/4.6/html-has-lang?application=playwright\n   name: <html> element must have a lang attribute\n   description: Ensures every HTML document has a lang attribute\n   WCAG: 'WCAG 2.0 Level A'\n\n")))}m.isMDXComponent=!0}}]);