"use strict";(self.webpackChunkstacks=self.webpackChunkstacks||[]).push([[9387],{3088:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var s=n(4848),r=n(8453);const i={},d=void 0,o={id:"getting_started/next/next-auth-redis",title:"next-auth-redis",description:"@ensono-stacks/next:next-auth-redis",source:"@site/docs/getting_started/next/next-auth-redis.md",sourceDirName:"getting_started/next",slug:"/getting_started/next/next-auth-redis",permalink:"/docs/getting_started/next/next-auth-redis",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{}},a={},c=[{value:"@ensono-stacks/next",id:"ensono-stacksnext",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Usage",id:"usage",level:2},{value:"Command line arguments",id:"command-line-arguments",level:3},{value:"Generator Output",id:"generator-output",level:3}];function l(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components},{Details:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.h3,{id:"ensono-stacksnext",children:["@ensono-stacks/next",":next-auth-redis"]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Add Redis for session management to your Next application"}),(0,s.jsx)(t.p,{children:"The next-auth-redis generator will add Redis for session management into your existing Next app with Next-auth."}),(0,s.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),(0,s.jsxs)(t.p,{children:["An existing ",(0,s.jsx)(t.a,{href:"https://nextjs.org/",children:"Next"})," application with Next-auth. Use the ",(0,s.jsx)(t.code,{children:"@ensono-stacks/next:next-auth"})," generator to add this into your application"]}),(0,s.jsx)(t.h2,{id:"usage",children:"Usage"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"nx g @ensono-stacks/next:next-auth-redis\n"})}),(0,s.jsx)(t.h3,{id:"command-line-arguments",children:"Command line arguments"}),(0,s.jsx)(t.p,{children:"The following command line arguments are available:"}),(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Option"}),(0,s.jsx)(t.th,{children:"Description"}),(0,s.jsx)(t.th,{children:"Type"}),(0,s.jsx)(t.th,{children:"Accepted Values"}),(0,s.jsx)(t.th,{children:"Default"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"--project"}),(0,s.jsx)(t.td,{children:"The name of the project"}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"N/A"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"--adapterName"}),(0,s.jsx)(t.td,{children:"Name of the generated Redis adapter library"}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{}),(0,s.jsx)(t.td,{children:"next-auth-redis"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"--envVar"}),(0,s.jsx)(t.td,{children:"Name of the env var that stores connection string for Redis"}),(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{}),(0,s.jsx)(t.td,{children:"REDIS_URL"})]})]})]}),(0,s.jsx)(t.h3,{id:"generator-output",children:"Generator Output"}),(0,s.jsxs)(t.p,{children:["A new redis library will be added to your ",(0,s.jsx)(t.code,{children:"libs"})," folder with the following structure:"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"libs\n\u2502   next-auth-redis\n\u2502   \u251c\u2500\u2500  src\n\u2502   \u2502   \u251c\u2500\u2500 index.ts       #All code required for session management with Redis\n\u2502   \u2502   \u251c\u2500\u2500 index.test.ts  #Unit tests using 'ioredis-mock' to mock Redis functions.\n\u2502   \u251c\u2500\u2500  README.md\n\u2502   \u251c\u2500\u2500 tsconfig.json\n\u2502   \u251c\u2500\u2500 tsconfig.lib.json\n\u2502   \u251c\u2500\u2500 project.json\n\u2502   \u251c\u2500\u2500 .eslintrc.json\n\u2502   \u251c\u2500\u2500 jest.config.ts\n\u2514\u2500\u2500 \u2514\u2500\u2500 tsconfig.spec.json\n"})}),(0,s.jsx)(t.p,{children:'In order for Redis to be used within next-auth a new entry for the redis library is added to the tsconfig.base.json "paths"'}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'"paths": {\n      "@<workspace-name>/next-auth-redis": [\n        "libs/next-auth-redis/src/index.ts"\n      ]\n    }\n'})}),(0,s.jsxs)(t.p,{children:["Your ",(0,s.jsx)(t.code,{children:"[...nextauth].ts"})," file within the Next application will be updated to use the new Redis adapter:"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import { Redis } from 'ioredis';\nimport NextAuth from 'next-auth';\nimport AzureADProvider from 'next-auth/providers/azure-ad';\n\nimport { IORedisAdapter } from '@0-5-23-next-with-test-app/next-auth-redis';\n\nconst nextAuth = NextAuth({\n  providers: [\n    AzureADProvider({\n      clientId: process.env.AZURE_AD_CLIENT_ID,\n      clientSecret: process.env.AZURE_AD_CLIENT_SECRET,\n      tenantId: process.env.AZURE_AD_TENANT_ID,\n    }),\n  ],\n  adapter: IORedisAdapter(new Redis(process.env.REDIS_URL)),\n});\n\nexport default nextAuth;\n"})}),(0,s.jsxs)(t.p,{children:["A final message is provided if the developer would like to run the relevant deployment generator that supports this FE.\n",(0,s.jsx)(t.code,{children:"@ensono-stacks/next:next-auth-redis-deployment"}),"."]})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>o});var s=n(6540);const r={},i=s.createContext(r);function d(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);