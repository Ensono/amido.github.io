"use strict";(self.webpackChunkstacks=self.webpackChunkstacks||[]).push([[5252,4723,812,5417],{3936:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var s=t(4848),r=t(8453);const o={},i=void 0,a={id:"getting_started/next/init",title:"init",description:"@ensono-stacks/next:init",source:"@site/docs/getting_started/next/init.md",sourceDirName:"getting_started/next",slug:"/getting_started/next/init",permalink:"/docs/getting_started/next/init",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{}},l={},d=[{value:"@ensono-stacks/next",id:"ensono-stacks-next-init",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Usage",id:"usage",level:2},{value:"Command line arguments",id:"command-line-arguments",level:3},{value:"Generator Output",id:"generator-output",level:3}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h3,{id:"ensono-stacks-next-init",children:["@ensono-stacks/next",":init"]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Adds custom config and developer tools to an existing next application"}),(0,s.jsxs)(n.p,{children:["The next init generator will add a custom ESlint config to an existing NextJs application, install ",(0,s.jsx)(n.code,{children:"eslint-plugin-testing-library"})," to the project. as well as update project.json with a custom test config to allow coverage collection from ",(0,s.jsx)(n.a,{href:"https://jestjs.io/",children:"jest"}),"."]}),(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),(0,s.jsxs)(n.p,{children:["An existing ",(0,s.jsx)(n.a,{href:"https://nextjs.org/",children:"Next"})," application"]}),(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nx g @ensono-stacks/next:init\n"})}),(0,s.jsx)(n.h3,{id:"command-line-arguments",children:"Command line arguments"}),(0,s.jsx)(n.p,{children:"The following command line arguments are available:"}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Accepted Values"}),(0,s.jsx)(n.th,{children:"Default"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--project"}),(0,s.jsx)(n.td,{children:"Name of the existing next application"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"nameOfApplication"}),(0,s.jsx)(n.td,{children:"N/A"})]})})]}),(0,s.jsx)(n.h3,{id:"generator-output",children:"Generator Output"}),(0,s.jsx)(n.p,{children:"The following files will be updated."}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"UPDATE apps/baseline-next-app/project.json #Updated with custom test config to allow for coverage collection\nUPDATE apps/baseline-next-app/.eslintrc.json #Ehanced with additional linting rules\nUPDATE apps/baseline-next-app/tsconfig.json #Minor enhancements\nUPDATE apps/baseline-next-app/tsconfig.spec.json #Updates for monorepo structure\nUPDATE apps/baseline-next-app/specs/index.spec.tsx #Formatting changes\n"})}),(0,s.jsxs)(n.p,{children:["The generator will also add ",(0,s.jsx)(n.a,{href:"https://github.com/dequelabs/axe-core-npm/blob/develop/packages/react/README.md",children:"react-axe"})," (version 4.7.3) into the app via the following:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:'title="...app.tsx"',children:"// @ts-ignore\nif (typeof window !== 'undefined' && process.env.NODE_ENV !== 'production') {\n    // eslint-disable-next-line global-require\n    const axe = require('@axe-core/react'); // eslint-disable-line @typescript-eslint/no-var-requires\n    // eslint-disable-next-line global-require\n    const React = require('react'); // eslint-disable-line @typescript-eslint/no-var-requires\n    // eslint-disable-next-line global-require\n    const ReactDOM = require('react-dom'); // eslint-disable-line @typescript-eslint/no-var-requires\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    axe(React, ReactDOM, 1000);\n}\n\n...\n"})}),(0,s.jsx)(n.p,{children:"react-axe has been added so your app can be tested for accessibility and results will show in the Chrome DevTools console."})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8598:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var s=t(4848),r=t(8453);const o={},i=void 0,a={id:"getting_started/next/next-auth",title:"next-auth",description:"@ensono-stacks/next:next-auth",source:"@site/docs/getting_started/next/next-auth.md",sourceDirName:"getting_started/next",slug:"/getting_started/next/next-auth",permalink:"/docs/getting_started/next/next-auth",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{}},l={},d=[{value:"@ensono-stacks/next",id:"ensono-stacks-next-next-auth",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Usage",id:"usage",level:2},{value:"Command line arguments",id:"command-line-arguments",level:3},{value:"Generator Output",id:"generator-output",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h3,{id:"ensono-stacks-next-next-auth",children:["@ensono-stacks/next",":next-auth"]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Add Next Authentication to your next application"}),(0,s.jsxs)(n.p,{children:["The next-auth generator will create a new library and configure ",(0,s.jsx)(n.a,{href:"https://next-auth.js.org/",children:"NextAuth.js"})," into an existing Next application. It will add the initial configuration, add the session provider, setup an API endpoint and add local environmental variables. It will also configure provider specific setup."]}),(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),(0,s.jsxs)(n.p,{children:["An existing ",(0,s.jsx)(n.a,{href:"https://nextjs.org/",children:"Next"})," application"]}),(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nx g @ensono-stacks/next:next-auth\n"})}),(0,s.jsx)(n.h3,{id:"command-line-arguments",children:"Command line arguments"}),(0,s.jsx)(n.p,{children:"The following command line arguments are available:"}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Accepted Values"}),(0,s.jsx)(n.th,{children:"Default"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--name"}),(0,s.jsx)(n.td,{children:"The name of the library"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"N/A"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--directory"}),(0,s.jsx)(n.td,{children:"The location of where the library should be installed"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"N/A"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--project"}),(0,s.jsx)(n.td,{children:"The name of the project"}),(0,s.jsx)(n.td,{children:"nameOfApplication"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"N/A"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--provider"}),(0,s.jsx)(n.td,{children:"The provider to be installed"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"none, microsoft-entra-id, auth0"}),(0,s.jsx)(n.td,{children:"none"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--sessionStorage"}),(0,s.jsx)(n.td,{children:"The session storage to be used"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"cookie, redis"}),(0,s.jsx)(n.td,{children:"cookie"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--guestSession"}),(0,s.jsx)(n.td,{children:"Enable guest sessioins"}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"true/false"}),(0,s.jsx)(n.td,{children:"true"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--importPath"}),(0,s.jsx)(n.td,{children:"The library name used to import it"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"N/A"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--skipPackageJson"}),(0,s.jsxs)(n.td,{children:["Do not add dependencies to ",(0,s.jsx)(n.code,{children:"package.json"})]}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"true/false"}),(0,s.jsx)(n.td,{children:"false"})]})]})]}),(0,s.jsx)(n.h3,{id:"generator-output",children:"Generator Output"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Creates a new Library with the given name. Contains the configuration for Auth.js, including provider and adapter setup, config, and token rotation."}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",metastring:'title="Generated files"',children:"\u251c\u2500\u2500 auth\n\u2502   \u251c\u2500\u2500 src\n\u2502   \u2502   \u251c\u2500\u2500 actions\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 oauth.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 profile.ts\n\u2502   \u2502   \u251c\u2500\u2500 adapter\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 redis-adapter.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 redis-repository.ts\n\u2502   \u2502   \u251c\u2500\u2500 callbacks\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 jwt.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 session.ts\n\u2502   \u2502   \u251c\u2500\u2500 providers\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 auth0.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 guest.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u2502   \u251c\u2500\u2500 types\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 index.d.ts\n\u2502   \u2502   \u251c\u2500\u2500 utils\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 guards.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u2502   \u251c\u2500\u2500 config.ts\n\u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u251c\u2500\u2500 .eslintrc.json\n\u2502   \u251c\u2500\u2500 jest.config.ts\n\u2502   \u251c\u2500\u2500 project.json\n\u2502   \u251c\u2500\u2500 README.md\n\u2502   \u251c\u2500\u2500 tsconfig.json\n\u2502   \u251c\u2500\u2500 tsconfig.lib.json\n\u2514\u2500\u2500 \u2514\u2500\u2500 tsconfig.spec.json\n"})}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Creates a new Next API endpoint with the file name ",(0,s.jsx)(n.code,{children:"[...nextauth].ts"}),". This contains the dynamic route handler for NextAuth.js which will also contain all of your global NextAuth.js configurations. If you have specified a provider when running the generator this will be added to the providers array"]}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:'title="/apps/appName/src/app/api/auth/[...nextauth]/route.ts"',children:'import { handlers } from "@my-stacks-workspace/auth";\n\nexport const { GET, POST } = handlers;\n'})}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Install the next-auth package and add to package.json, unless the ",(0,s.jsx)(n.code,{children:"--skipPackageJson"})," option was used"]}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="/package.json"',children:'"dependencies": {\n    ...otherDependencies\n    "next-auth": "5.0.0-beta.19",\n    "ioredis": "5.4.1", // if using --sessionStorage=redis\n},\n'})}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Create or append an ",(0,s.jsx)(n.code,{children:".env.local"})," file. Adding required next auth environmental variables. These will vary depending on the provider chosen."]}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:'title="/.env.local"',children:"NEXTAUTH_URL=http://localhost:4200\nNEXTAUTH_SECRET=secretValue\nAZURE_AD_CLIENT_ID=\nAZURE_AD_CLIENT_SECRET=\nAZURE_AD_TENANT_ID=\n"})}),(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Be sure to update the environmental variables with the values provided by your provider"})}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Wrap client components with a ",(0,s.jsx)(n.a,{href:"https://next-auth.js.org/getting-started/client#sessionprovider",children:"session provider"})," to access session state."]}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",metastring:'title="/apps/appName/src/components/client-component.tsx"',children:'"use client";\n\nimport { useSession } from "next-auth/react";\n\nexport default function ClientComponent() {\n  const { data } = useSession();\n\n  if (!data || !data.user || data.user.role === "guest") {\n    return null;\n  }\n\n  return <div>{data.user.name}</div>;\n}\n'})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",metastring:'title="/apps/appName/src/app/page.tsx"',children:'import { SessionProvider } from "next-auth/react";\n\nimport { auth } from "@my-stacks-workspace/auth";\n\nimport ClientComponent from "../components/client-component";\nimport GuestSessionProvider from "../components/guest-session";\n\nexport default async function Index() {\n  const session = await auth();\n  return (\n    <>\n      <SessionProvider session={session}>\n        <GuestSessionProvider />\n        <ClientComponent />\n      </SessionProvider>\n    </>\n  );\n}\n'})}),(0,s.jsxs)(n.p,{children:["For further information please see the ",(0,s.jsx)(n.a,{href:"https://next-auth.js.org/getting-started/example#frontend---add-react-hook",children:"Getting Started Guide to Next Auth"})]})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},226:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>h,default:()=>j,frontMatter:()=>c,metadata:()=>u,toc:()=>x});var s=t(4848),r=t(8453),o=t(3936),i=t(8598),a=t(2224),l=t(1470),d=t(9365);const c={id:"ensono-stacks-next",title:"@ensono-stacks/next",sidebar_label:"@ensono-stacks/next",description:"Using next with Ensono Stacks!",keywords:["NX","monorepo","stacks","ensono","next","generator","executor","redis"]},h=void 0,u={id:"getting_started/next/ensono-stacks-next",title:"@ensono-stacks/next",description:"Using next with Ensono Stacks!",source:"@site/docs/getting_started/next/plugin-information.md",sourceDirName:"getting_started/next",slug:"/getting_started/next/ensono-stacks-next",permalink:"/docs/getting_started/next/ensono-stacks-next",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"ensono-stacks-next",title:"@ensono-stacks/next",sidebar_label:"@ensono-stacks/next",description:"Using next with Ensono Stacks!",keywords:["NX","monorepo","stacks","ensono","next","generator","executor","redis"]},sidebar:"docs",previous:{title:"@ensono-stacks/workspace",permalink:"/docs/getting_started/workspace/ensono-stacks-workspace"},next:{title:"@ensono-stacks/azure-node",permalink:"/docs/getting_started/azure-node/ensono-stacks-azure-node"}},p={},x=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setting up @ensono-stacks/next",id:"setting-up-ensono-stacksnext",level:2},{value:"Executors and Generators",id:"executors-and-generators",level:2},{value:"Generators",id:"generators",level:3},...o.toc,...i.toc,...a.toc];function g(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"next"})," plugin contains generators to augment existing NextJs projects. Adding eslint rules, testing config as well as installing and configuring NextAuth.js in your NextJs app."]}),"\n",(0,s.jsx)(n.p,{children:"Using a standard setup for your Next app ensures consistency and code quality across multiple applications quickly. NextAuth (alongside Redis) can also be quickly added to a project without costly configuration and setup."}),"\n",(0,s.jsx)(n.p,{children:"Using the deployment generator you can setup your application with the necessary infrastructure config to host it in k8s."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.p,{children:["An existing ",(0,s.jsx)(n.a,{href:"https://nextjs.org/",children:"Next"})," application. Note the generator will fail if run in an empty workspace with no applications. To create a new Next application please run the NX Next generator with the following command including any relevant options. See ",(0,s.jsx)(n.a,{href:"https://nx.dev/packages/next",children:"@nx/next plugin docs"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nx g @nx/next:app my-new-app\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Ensure the ",(0,s.jsx)(n.code,{children:"stacks"})," -> ",(0,s.jsx)(n.code,{children:"executedGenerators"})," fields are present within ",(0,s.jsx)(n.code,{children:"nx.json"})," for FE code generation."]}),"\n",(0,s.jsxs)(n.p,{children:["Ensure the ",(0,s.jsx)(n.code,{children:"stacks"})," -> ",(0,s.jsx)(n.code,{children:"config"})," fields are present and populated within ",(0,s.jsx)(n.code,{children:"nx.json"})," for deployment/infra generation."]}),"\n",(0,s.jsxs)(n.p,{children:["An example of the expected structure can be ",(0,s.jsx)(n.a,{href:"/docs/getting_started/workspace/ensono-stacks-workspace#prerequisites",children:"seen here"})," under ",(0,s.jsx)(n.code,{children:"@ensono-stacks/workspace:init"}),"\u200b prerequisites."]}),"\n",(0,s.jsx)(n.h2,{id:"setting-up-ensono-stacksnext",children:"Setting up @ensono-stacks/next"}),"\n",(0,s.jsxs)(n.p,{children:["Install the ",(0,s.jsx)(n.code,{children:"@ensono-stacks/next"})," with the following command:"]}),"\n",(0,s.jsxs)(l.A,{children:[(0,s.jsx)(d.A,{value:"npm",label:"npm",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install --save-dev @ensono-stacks/next@latest\n"})})}),(0,s.jsx)(d.A,{value:"yarn",label:"yarn",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yarn add --dev @ensono-stacks/next@latest\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"executors-and-generators",children:"Executors and Generators"}),"\n",(0,s.jsx)(n.p,{children:"To see a list of the plugin capabilities run the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nx list @ensono-stacks/next\n"})}),"\n",(0,s.jsx)(n.p,{children:"View additional information about a plugin capability through the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nx g @ensono-stacks/next:[generator-executor-name] --help\n"})}),"\n",(0,s.jsx)(n.h3,{id:"generators",children:"Generators"}),"\n",(0,s.jsx)(o.default,{}),"\n",(0,s.jsx)(i.default,{}),"\n",(0,s.jsx)(a.default,{})]})}function j(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(g,{...e})}):g(e)}},2224:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var s=t(4848),r=t(8453);const o={},i=void 0,a={id:"getting_started/next/storybook",title:"storybook",description:"@ensono-stacks/next:storybook",source:"@site/docs/getting_started/next/storybook.md",sourceDirName:"getting_started/next",slug:"/getting_started/next/storybook",permalink:"/docs/getting_started/next/storybook",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{}},l={},d=[{value:"@ensono-stacks/next",id:"ensono-stacks-next-storybook",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Usage",id:"usage",level:2},{value:"Command line arguments",id:"command-line-arguments",level:3},{value:"Generator Output",id:"generator-output",level:3},{value:"Custom command for app",id:"custom-command-for-app",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h3,{id:"ensono-stacks-next-storybook",children:["@ensono-stacks/next",":storybook"]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Add Storybook to your next application"}),(0,s.jsxs)(n.p,{children:["The storybook generator will install and configure ",(0,s.jsx)(n.a,{href:"https://storybook.js.org/",children:"Storybook"})," into an existing Next application.\nIt will add storybook configuration, a custom component command and storybook extensions. The following extensions are:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'        {\n            "@storybook/addon-essentials": "7.4.5",\n            "@storybook/addon-actions": "7.4.5",\n            "@storybook/addon-links": "7.4.5",\n            "@storybook/manager-api": "7.4.5",\n            "@storybook/preview-api": "7.4.5",\n            "@storybook/addon-a11y": "7.4.5",\n            "@storybook/addon-jest": "7.4.5",\n            "@storybook/theming": "7.4.5",\n        },\n'})}),(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),(0,s.jsxs)(n.p,{children:["An existing ",(0,s.jsx)(n.a,{href:"https://nextjs.org/",children:"Next"})," application"]}),(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nx g @ensono-stacks/next:storybook\n"})}),(0,s.jsx)(n.h3,{id:"command-line-arguments",children:"Command line arguments"}),(0,s.jsx)(n.p,{children:"The following command line arguments are available:"}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Accepted Values"}),(0,s.jsx)(n.th,{children:"Default"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--project"}),(0,s.jsx)(n.td,{children:"The name of the project"}),(0,s.jsx)(n.td,{children:"nameOfApplication"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"N/A"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--skipPackageJson"}),(0,s.jsxs)(n.td,{children:["Do not add dependencies to ",(0,s.jsx)(n.code,{children:"package.json"})]}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"true/false"}),(0,s.jsx)(n.td,{children:"false"})]})]})]}),(0,s.jsx)(n.h3,{id:"generator-output",children:"Generator Output"}),(0,s.jsx)(n.p,{children:"The generator creates the following:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["creates a new folder ",(0,s.jsx)(n.code,{children:".storybook"}),". This contains information for the storybook package.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"main.js file is created"}),"\n",(0,s.jsx)(n.li,{children:"preview.js file is created"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["creates a new file ",(0,s.jsx)(n.code,{children:"tsconfig.storybook.json"})," to store configuration for storybook"]}),"\n"]}),(0,s.jsx)(n.p,{children:"The generator updates the following:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["updates the ",(0,s.jsx)(n.code,{children:"project.json"})," file to add the ",(0,s.jsx)(n.code,{children:"custom-component"})," command"]}),"\n"]}),(0,s.jsxs)(n.p,{children:["The generator installs the follow dependencies unless the ",(0,s.jsx)(n.code,{children:"--skipPackageJson"})," option was used:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="/package.json"',children:'{\n  "dependencies": {\n    "@storybook/core-server": "7.4.5"\n  },\n  "devDependencies": {\n    "@nx/storybook": "16.9.1",\n    "@storybook/nextjs": "7.4.5",\n    "@storybook/addon-essentials": "7.4.5",\n    "@storybook/addon-actions": "7.4.5",\n    "@storybook/addon-links": "7.4.5",\n    "@storybook/manager-api": "7.4.5",\n    "@storybook/preview-api": "7.4.5",\n    "@storybook/addon-a11y": "7.4.5",\n    "@storybook/addon-jest": "7.4.5",\n    "@storybook/theming": "7.4.5",\n    "eslint-plugin-storybook": "0.6.15"\n  }\n}\n'})}),(0,s.jsx)(n.h3,{id:"custom-command-for-app",children:"Custom command for app"}),(0,s.jsxs)(n.p,{children:["After the Storybook generator has been installed you can now run the new command ",(0,s.jsx)(n.code,{children:"custom-component"})," that will add the following:"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"creates a component under a specified name"}),"\n",(0,s.jsx)(n.li,{children:"creates a test for the new component"}),"\n",(0,s.jsx)(n.li,{children:"creates a story for the new component"}),"\n"]}),(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"my-app"})," is an example of your app's name."]})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nx run my-app:custom-component --name=component-x --folderPath=components\n"})}),(0,s.jsx)(n.p,{children:"The flags are the following:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"name: name of the component"}),"\n",(0,s.jsx)(n.li,{children:"folderPath: path of the new component folder (based on the app as the root of the path)"}),"\n"]})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},9365:(e,n,t)=>{t.d(n,{A:()=>i});t(6540);var s=t(4164);const r={tabItem:"tabItem_Ymn6"};var o=t(4848);function i(e){let{children:n,hidden:t,className:i}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,s.A)(r.tabItem,i),hidden:t,children:n})}},1470:(e,n,t)=>{t.d(n,{A:()=>y});var s=t(6540),r=t(4164),o=t(3104),i=t(6347),a=t(205),l=t(7485),d=t(1682),c=t(679);function h(e){var n,t;return null!=(n=null==(t=s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function u(e){const{values:n,children:t}=e;return(0,s.useMemo)((()=>{const e=null!=n?n:function(e){return h(e).map((e=>{let{props:{value:n,label:t,attributes:s,default:r}}=e;return{value:n,label:t,attributes:s,default:r}}))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function x(e){let{queryString:n=!1,groupId:t}=e;const r=(0,i.W6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,l.aZ)(o),(0,s.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(r.location.search);n.set(o,e),r.replace({...r.location,search:n.toString()})}),[o,r])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,o=u(e),[i,l]=(0,s.useState)((()=>function(e){var n;let{defaultValue:t,tabValues:s}=e;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:s}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+s.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const r=null!=(n=s.find((e=>e.default)))?n:s[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:o}))),[d,h]=x({queryString:t,groupId:r}),[g,j]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[r,o]=(0,c.Dv)(t);return[r,(0,s.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:r}),m=(()=>{const e=null!=d?d:g;return p({value:e,tabValues:o})?e:null})();(0,a.A)((()=>{m&&l(m)}),[m]);return{selectedValue:i,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error("Can't select invalid tab value="+e);l(e),h(e),j(e)}),[h,j,o]),tabValues:o}}var j=t(2303);const m={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(4848);function b(e){let{className:n,block:t,selectedValue:s,selectValue:i,tabValues:a}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),r=a[t].value;r!==s&&(d(n),i(r))},h=e=>{var n;let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{var s;const n=l.indexOf(e.currentTarget)+1;t=null!=(s=l[n])?s:l[0];break}case"ArrowLeft":{var r;const n=l.indexOf(e.currentTarget)-1;t=null!=(r=l[n])?r:l[l.length-1];break}}null==(n=t)||n.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:a.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>l.push(e),onKeyDown:h,onClick:c,...o,className:(0,r.A)("tabs__item",m.tabItem,null==o?void 0:o.className,{"tabs__item--active":s===n}),children:null!=t?t:n},n)}))})}function v(e){let{lazy:n,children:t,selectedValue:o}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===o));return e?(0,s.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==o})))})}function k(e){const n=g(e);return(0,f.jsxs)("div",{className:(0,r.A)("tabs-container",m.tabList),children:[(0,f.jsx)(b,{...n,...e}),(0,f.jsx)(v,{...n,...e})]})}function y(e){const n=(0,j.A)();return(0,f.jsx)(k,{...e,children:h(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var s=t(6540);const r={},o=s.createContext(r);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);