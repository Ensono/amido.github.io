"use strict";(self.webpackChunkstacks=self.webpackChunkstacks||[]).push([[3309],{5550:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var n=s(4848),r=s(8453);const i={},a=void 0,o={id:"getting_started/cypress/init-deployment",title:"init-deployment",description:"@ensono-stacks/cypress:init-deployment",source:"@site/docs/getting_started/cypress/init-deployment.md",sourceDirName:"getting_started/cypress",slug:"/getting_started/cypress/init-deployment",permalink:"/docs/getting_started/cypress/init-deployment",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{}},l={},c=[{value:"@ensono-stacks/cypress",id:"ensono-stackscypress",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Usage",id:"usage",level:2},{value:"Generator Output",id:"generator-output",level:3}];function d(e){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components},{Details:s}=t;return s||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.h3,{id:"ensono-stackscypress",children:["@ensono-stacks/cypress",":init-deployment"]}),"\n",(0,n.jsxs)(s,{children:[(0,n.jsx)("summary",{children:"Add cypress E2E tests to your deployment pipelines"}),(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.em,{children:"init-deployment"})," generator adds e2e testing to pre-existing deployment pipelines, including test reporting and artefact uploads."]}),(0,n.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsxs)(t.a,{href:"/docs/getting_started/workspace/ensono-stacks-workspace#ensono-stacksworkspaceinit-deployment",children:["@ensono-stacks/workspace",":init-deployment"]})," has been executed, producing the required deployment files for the workspace"]}),"\n"]}),(0,n.jsx)(t.h2,{id:"usage",children:"Usage"}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"nx g @ensono-stacks/cypress:init-deployment\n"})}),(0,n.jsx)(t.h3,{id:"generator-output",children:"Generator Output"}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",metastring:"title=build/taskctl/tasks.yaml",children:'# New e2e:ci task definition will be added to the tasks.yaml, defining what target should be ran for projects when executing the e2e task\r\ne2e:ci:\r\n    description: Run e2e tests in ci\r\n    command:\r\n      - npx nx affected --base="$BASE_SHA" --target=e2e --parallel=1\n'})}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",metastring:"title=taskctl.yaml",children:"# New e2e:ci task will be added to the taskctl pipeline, adding e2e tests following unit testing\r\n- task: e2e:ci\r\n    depends_on: test:ci\n"})}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",metastring:"build/azDevOps/azuredevops-stages.yaml",children:"# Generate HTML report for all affected projects\r\n- task: Bash@3\r\n            condition: and(succeededOrFailed(),eq(variables.HASTESTRESULTS, 'true'))\r\n            displayName: Generate Reports\r\n            inputs:\r\n              targetType: inline\r\n              script: npx nx affected --base=\"$BASE_SHA\" --target=html-report\r\n                --configuration=ci --parallel=1\r\n# New test reporting steps will be added to the azuredevops pipeline\r\n- task: PublishTestResults@2\r\n    # Configuration for publishing test results\r\n- task: PublishPipelineArtifact@1\r\n    # Configuration for publishing pipeline artefacts\n"})})]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var n=s(6540);const r={},i=n.createContext(r);function a(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);