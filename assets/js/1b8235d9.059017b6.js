"use strict";(self.webpackChunkstacks=self.webpackChunkstacks||[]).push([[9157],{7215:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"getting_started/azure-react/generator-app-insights-web","title":"generator-app-insights-web","description":"@ensono-stacks/azure-react:app-insights-web","source":"@site/docs/getting_started/azure-react/generator-app-insights-web.md","sourceDirName":"getting_started/azure-react","slug":"/getting_started/azure-react/generator-app-insights-web","permalink":"/docs/getting_started/azure-react/generator-app-insights-web","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var s=t(4848),r=t(8453);const a={},o=void 0,c={},l=[{value:"@ensono-stacks/azure-react",id:"ensono-stacksazure-react",level:3},{value:"Usage",id:"usage",level:2},{value:"Command line arguments",id:"command-line-arguments",level:3},{value:"Generator Output",id:"generator-output",level:3},{value:"Using Application Insights",id:"using-application-insights",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h3,{id:"ensono-stacksazure-react",children:["@ensono-stacks/azure-react",":app-insights-web"]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Installs and configures a ReactJS Library with App Insights."}),(0,s.jsx)(n.p,{children:"This enables the following:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Tracking of router changes"}),"\n",(0,s.jsx)(n.li,{children:"React components usage statistics"}),"\n"]}),(0,s.jsxs)(n.p,{children:["This generator will create a new ReactJS Library with ",(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@microsoft/applicationinsights-react-js",children:"applicationinsights reactjs"})," and ",(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@microsoft/applicationinsights-web",children:"applicationinsights web"})," npm packages installed and configured for you. This can then be imported an used in an existing ReactJS application."]}),(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nx generate @ensono-stacks/azure-react:app-insights-web\n"})}),(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["App insights requires the connection string environment variable to be set to the value set within Azure. The name of the connection string variable is set in the generator options ",(0,s.jsx)(n.code,{children:"--connectionString"}),". Please see ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-gb/azure/azure-monitor/app/sdk-connection-string?tabs=net",children:"documentation on connection strings"})," for more information"]})}),(0,s.jsx)(n.h3,{id:"command-line-arguments",children:"Command line arguments"}),(0,s.jsx)(n.p,{children:"The following command line arguments are available:"}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Required"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--name"}),(0,s.jsx)(n.td,{children:"Library name"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"Required"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--connectionString"}),(0,s.jsx)(n.td,{children:"The env variable for the connection string."}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"Required"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--directory"}),(0,s.jsx)(n.td,{children:"A directory where the lib is placed."}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"Optional"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--importPath"}),(0,s.jsx)(n.td,{children:"What import path would you like to use for the library?."}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"Optional"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--tags"}),(0,s.jsx)(n.td,{children:"Add tags to the library (used for linting)."}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"Optional"})]})]})]}),(0,s.jsx)(n.h3,{id:"generator-output",children:"Generator Output"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Adds an app insights config file"}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="/src/app-insights-config.ts"',children:"// eslint-disable-next-line import/no-extraneous-dependencies\nimport {\n  DistributedTracingModes,\n  IConfig,\n} from '@microsoft/applicationinsights-common';\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport type { IConfiguration } from '@microsoft/applicationinsights-core-js';\n\nconst appInsightConfig: IConfiguration & IConfig = {\n  enableAutoRouteTracking: false,\n  enableCorsCorrelation: true,\n  enableRequestHeaderTracking: true,\n  enableResponseHeaderTracking: true,\n  disableFetchTracking: false,\n  distributedTracingMode: DistributedTracingModes.AI_AND_W3C,\n  enableAjaxPerfTracking: true\n};\n\nexport default appInsightConfig;\n"})}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Adds a telemetry provider"}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="/src/telemetry-provider.tsx"',children:"import {\n  ReactPlugin,\n  AppInsightsContext,\n} from '@microsoft/applicationinsights-react-js';\nimport { ApplicationInsights } from '@microsoft/applicationinsights-web';\nimport { FC, ReactNode } from 'react';\n\nimport appInsightConfig from './app-insights-config';\n\nconst reactPlugin = new ReactPlugin();\nconst connectionString = process.env.<%= connectionString %>;\n\nexport const appInsights = new ApplicationInsights({\n  config: {\n    connectionString,\n    ...appInsightConfig,\n    extensions: [reactPlugin],\n  },\n});\n\nif (!appInsights.appInsights.isInitialized()) {\n  appInsights.loadAppInsights();\n}\n\nexport const TelemetryProvider: FC<{ children?: ReactNode }> = ({ children }) => (\n  <AppInsightsContext.Provider value={reactPlugin}>\n    {children}\n  </AppInsightsContext.Provider>\n);\n"})}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Installs and adds microsoft applicationinsights packages to package.json"}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="/package.json"',children:'  "dependencies": {\n    ...OtherDependencies\n    "@microsoft/applicationinsights-react-js": "3.4.0",\n    "@microsoft/applicationinsights-web": "2.8.9",\n  }\n}\n'})}),(0,s.jsx)(n.h3,{id:"using-application-insights",children:"Using Application Insights"}),(0,s.jsx)(n.p,{children:"To use the Application Insights react hooks within your application please import the generated library and wrap your application in the TelemetryProvider installed by the generator for example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:"import NxWelcome from './nx-welcome';\nimport { TelemetryProvider } from 'packages/nameOfGeneratedAppInsightsLibrary/src';\n\nexport function App() {\n    return (\n        <TelemetryProvider>\n            <NxWelcome title=\"welcome title\" />\n            <div />\n        </TelemetryProvider>\n    );\n}\n\nexport default App;\n\n"})}),(0,s.jsxs)(n.p,{children:["From here a ",(0,s.jsx)(n.code,{children:"useAppInsightsContext"})," hook will be available to use anywhere within your ReactJS App. For example"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'import React from "react";\nimport { useAppInsightsContext } from "@microsoft/applicationinsights-react-js";\n\nconst MyComponent = () => {\n    const appInsights = useAppInsightsContext();\n    const metricData = {\n        average: engagementTime,\n        name: "React Component Engaged Time (seconds)",\n        sampleCount: 1\n      };\n    const additionalProperties = { "Component Name": \'MyComponent\' };\n    appInsights.trackMetric(metricData, additionalProperties);\n    \n    return (\n        <h1>My Component</h1>\n    );\n}\nexport default MyComponent;\n'})}),(0,s.jsxs)(n.p,{children:["Full documentation and a getting started guide can be found at ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-gb/azure/azure-monitor/app/javascript-react-plugin",children:"React plug-in for Application Insights JavaScript SDK"})]})]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(6540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);