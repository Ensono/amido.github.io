"use strict";(self.webpackChunkstacks=self.webpackChunkstacks||[]).push([[6248],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=u(n),g=a,d=c["".concat(l,".").concat(g)]||c[g]||h[g]||i;return n?r.createElement(d,s(s({ref:t},p),{},{components:n})):r.createElement(d,s({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,s=new Array(i);s[0]=g;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:a,s[1]=o;for(var u=2;u<i;u++)s[u]=n[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},5162:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(7294),a=n(6010),i={tabItem:"tabItem_Ymn6"};function s(e){var t=e.children,n=e.hidden,s=e.className;return r.createElement("div",{role:"tabpanel",className:(0,a.Z)(i.tabItem,s),hidden:n},t)}},4866:function(e,t,n){n.d(t,{Z:function(){return k}});var r=n(7462),a=n(7294),i=n(6010),s=n(2466),o=n(6550),l=n(1980),u=n(7392),p=n(12);function c(e){return function(e){var t,n;return null!=(t=null==(n=a.Children.map(e,(function(e){if(!e||(0,a.isValidElement)(e)&&(t=e.props)&&"object"==typeof t&&"value"in t)return e;var t;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:n.filter(Boolean))?t:[]}(e).map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes,default:t.default}}))}function h(e){var t=e.values,n=e.children;return(0,a.useMemo)((function(){var e=null!=t?t:c(n);return function(e){var t=(0,u.l)(e,(function(e,t){return e.value===t.value}));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function g(e){var t=e.value;return e.tabValues.some((function(e){return e.value===t}))}function d(e){var t=e.queryString,n=void 0!==t&&t,r=e.groupId,i=(0,o.k6)(),s=function(e){var t=e.queryString,n=void 0!==t&&t,r=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=r?r:null}({queryString:n,groupId:r});return[(0,l._X)(s),(0,a.useCallback)((function(e){if(s){var t=new URLSearchParams(i.location.search);t.set(s,e),i.replace(Object.assign({},i.location,{search:t.toString()}))}}),[s,i])]}function m(e){var t,n,r,i,s=e.defaultValue,o=e.queryString,l=void 0!==o&&o,u=e.groupId,c=h(e),m=(0,a.useState)((function(){return function(e){var t,n=e.defaultValue,r=e.tabValues;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+r.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var a=null!=(t=r.find((function(e){return e.default})))?t:r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:s,tabValues:c})})),f=m[0],w=m[1],y=d({queryString:l,groupId:u}),b=y[0],v=y[1],k=(t=function(e){return e?"docusaurus.tab."+e:null}({groupId:u}.groupId),n=(0,p.Nk)(t),r=n[0],i=n[1],[r,(0,a.useCallback)((function(e){t&&i.set(e)}),[t,i])]),x=k[0],N=k[1],T=function(){var e=null!=b?b:x;return g({value:e,tabValues:c})?e:null}();return(0,a.useLayoutEffect)((function(){T&&w(T)}),[T]),{selectedValue:f,selectValue:(0,a.useCallback)((function(e){if(!g({value:e,tabValues:c}))throw new Error("Can't select invalid tab value="+e);w(e),v(e),N(e)}),[v,N,c]),tabValues:c}}var f=n(2389),w={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function y(e){var t=e.className,n=e.block,o=e.selectedValue,l=e.selectValue,u=e.tabValues,p=[],c=(0,s.o5)().blockElementScrollPositionUntilNextRender,h=function(e){var t=e.currentTarget,n=p.indexOf(t),r=u[n].value;r!==o&&(c(t),l(r))},g=function(e){var t,n=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":var r,a=p.indexOf(e.currentTarget)+1;n=null!=(r=p[a])?r:p[0];break;case"ArrowLeft":var i,s=p.indexOf(e.currentTarget)-1;n=null!=(i=p[s])?i:p[p.length-1]}null==(t=n)||t.focus()};return a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},t)},u.map((function(e){var t=e.value,n=e.label,s=e.attributes;return a.createElement("li",(0,r.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:function(e){return p.push(e)},onKeyDown:g,onClick:h},s,{className:(0,i.Z)("tabs__item",w.tabItem,null==s?void 0:s.className,{"tabs__item--active":o===t})}),null!=n?n:t)})))}function b(e){var t=e.lazy,n=e.children,r=e.selectedValue,i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){var s=i.find((function(e){return e.props.value===r}));return s?(0,a.cloneElement)(s,{className:"margin-top--md"}):null}return a.createElement("div",{className:"margin-top--md"},i.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==r})})))}function v(e){var t=m(e);return a.createElement("div",{className:(0,i.Z)("tabs-container",w.tabList)},a.createElement(y,(0,r.Z)({},e,t)),a.createElement(b,(0,r.Z)({},e,t)))}function k(e){var t=(0,f.Z)();return a.createElement(v,(0,r.Z)({key:String(t)},e))}},3315:function(e,t,n){n.r(t),n.d(t,{assets:function(){return h},contentTitle:function(){return p},default:function(){return f},frontMatter:function(){return u},metadata:function(){return c},toc:function(){return g}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),s=n(4866),o=n(5162),l=["components"],u={id:"testing_with_playwright",title:"Testing with Playwright",sidebar_label:"Testing with playwright",description:"Testing with playwright within an NX monorepo",keywords:["NX","testing","playwright","cross-browser"]},p=void 0,c={unversionedId:"testing/testing_in_nx/testing_with_playwright",id:"testing/testing_in_nx/testing_with_playwright",title:"Testing with Playwright",description:"Testing with playwright within an NX monorepo",source:"@site/docs/testing/testing_in_nx/playwright_nx.md",sourceDirName:"testing/testing_in_nx",slug:"/testing/testing_in_nx/testing_with_playwright",permalink:"/docs/testing/testing_in_nx/testing_with_playwright",draft:!1,tags:[],version:"current",frontMatter:{id:"testing_with_playwright",title:"Testing with Playwright",sidebar_label:"Testing with playwright",description:"Testing with playwright within an NX monorepo",keywords:["NX","testing","playwright","cross-browser"]},sidebar:"docs",previous:{title:"Frontend Testing in an Nx monorepo",permalink:"/docs/testing/testing_in_nx/frontend_testing_in_nx"},next:{title:"Accessibility Testing",permalink:"/docs/testing/testing_in_nx/playwright_accessibility_testing"}},h={},g=[{value:"Getting Started",id:"getting-started",level:2},{value:"Playwright Configuration",id:"playwright-configuration",level:2},{value:"Base configuration",id:"base-configuration",level:3},{value:"Project based configuration",id:"project-based-configuration",level:3},{value:"Browsers and Devices",id:"browsers-and-devices",level:3},{value:"Testing",id:"testing",level:2},{value:"Writing tests",id:"writing-tests",level:3},{value:"Running your playwright tests",id:"running-your-playwright-tests",level:3},{value:"Run specific tests",id:"run-specific-tests",level:4},{value:"Testing Output",id:"testing-output",level:2},{value:"Viewing your test results",id:"viewing-your-test-results",level:3},{value:"Locally",id:"locally",level:4},{value:"Output in CI",id:"output-in-ci",level:3}],d={toc:g},m="wrapper";function f(e){var t=e.components,u=(0,a.Z)(e,l);return(0,i.kt)(m,(0,r.Z)({},d,u,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Playwright is a relatively new testing framework, which is developed and supported by Microsoft. Playwright was designed to enable cross-browser web automation that is reliable and fast, with support for multiple browsers, programming languages and test runners. With a vast array of growing capabilities, alongside Microsoft backing, we are supporting and recommending it as a test framework within Ensono Stacks!"),(0,i.kt)("h2",{id:"getting-started"},"Getting Started"),(0,i.kt)("p",null,"Upon scaffolding your application with the playwright testing framework, you will be presented with an example test suite and playwright configuration. The ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/marksandspencer/nx-plugins/tree/main/packages/nx-playwright"},(0,i.kt)("inlineCode",{parentName:"a"},"@mands/nx-playwright"))," NX plugin is used as a base for the Playwright/NX integration. "),(0,i.kt)("h2",{id:"playwright-configuration"},"Playwright Configuration"),(0,i.kt)("h3",{id:"base-configuration"},"Base configuration"),(0,i.kt)("p",null,"The base configuration has been created with CI in mind, meaning the default configuration (shared across all projects) considers requirements for reporting and pipeline efficiency out of the box! "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="playwright.config.base.ts"',title:'"playwright.config.base.ts"'},"import { PlaywrightTestConfig } from '@playwright/test';\n\nconst baseURL = process.env.BASE_URL || 'http://localhost:4200/';\nconst appName = process.env.NX_TASK_TARGET_PROJECT || 'test-project';\nconst outputFolderForProject = process.env.CI ? '../../test-results/' + appName : 'test-results';\n\nexport const baseConfig: PlaywrightTestConfig = {\n  /* Run tests in files in parallel */\n  fullyParallel: true,\n  /* Fail the build on CI if you accidentally left test.only in the source code. */\n  forbidOnly: !!process.env.CI,\n  /* Retry on CI only */\n  retries: process.env.CI ? 2 : undefined,\n  /* Max failures in CI to fail fast */\n  maxFailures: process.env.CI ? 10 : undefined,\n  /* Timeout for each test in ms */\n  timeout: 30000,\n  /* The output directory for files created during test execution. */\n  outputDir: outputFolderForProject, \n  /* Reporter to use. */\n  reporter: process.env.CI\n    ? [\n        ['dot'],\n        ['html', { open: 'never', outputFolder: outputFolderForProject.concat('/html-report') } ],\n        ['junit', { outputFile: outputFolderForProject.concat('/', appName, '.xml') }],\n      ]\n    : 'list',\n  use: {\n    baseURL,\n  },\n};\n")),(0,i.kt)("h3",{id:"project-based-configuration"},"Project based configuration"),(0,i.kt)("p",null,"Individual project configuration has been created with our own recommendations to get the most out of playwright\u2019s capabilities, targeting multiple browsers and devices. From this example, you can tailor it to suit your specific needs! See the ",(0,i.kt)("a",{parentName:"p",href:"https://playwright.dev/docs/test-configuration"},"docs")," for more information! "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="playwright.config.ts"',title:'"playwright.config.ts"'},"import { type PlaywrightTestConfig, devices } from '@playwright/test';\n//Extends the base configuration for playwright which is shared across all projects\nimport { baseConfig } from '../../playwright.config.base';\n\n//Configuration unique to the current application tests\nconst config: PlaywrightTestConfig = {\n  ...baseConfig,\n  use: {\n    ...baseConfig.use,\n    screenshot: 'only-on-failure',\n    trace: 'retain-on-failure',\n  },\n\n  /* Test against multiple browsers */\n  projects: [\n    {\n      name: 'chromium',\n      use: {\n        ...devices['Desktop Chrome'],\n      },\n    },\n    {\n      name: 'firefox',\n      use: {\n        ...devices['Desktop Firefox'],\n      },\n    },\n\n    {\n      name: 'webkit',\n      use: {\n        ...devices['Desktop Safari'],\n      },\n    },\n\n    /* Test against mobile viewports. */\n    {\n      name: 'Mobile Chrome',\n      use: {\n        ...devices['Pixel 5'],\n      },\n    },\n    {\n      name: 'Mobile Safari',\n      use: {\n        ...devices['iPhone 12'],\n      },\n    },\n  ],\n};\n\nexport default config;\n")),(0,i.kt)("h3",{id:"browsers-and-devices"},"Browsers and Devices"),(0,i.kt)("p",null,"The scaffolded project configuration by default uses Desktop Chrome, Firefox and WebKit. Upon package install or test execution Playwright will automatically install the browsers defined within the running project. Other browsers are available, such as Microsoft Edge and HiDPI browsers. Additionally, the scaffolded project configuration contains two examples for mobile devices, Mobile Chrome on the Pixel 5, and WebKit on the iPhone 12."),(0,i.kt)("p",null,"Playwright has an extensive library of browsers and devices which can be found in the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/microsoft/playwright/blob/main/packages/playwright-core/src/server/deviceDescriptorsSource.json"},"device descriptors list"),". An example of a mobile emulation device is found below, showcasing how Playwright emulates the devices through ",(0,i.kt)("inlineCode",{parentName:"p"},"userAgent")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"viewport")," configuration, alongside mobile properties such as ",(0,i.kt)("inlineCode",{parentName:"p"},"isMobile"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"hasTouch"),". By default, each emulated device will have a ",(0,i.kt)("inlineCode",{parentName:"p"},"defaultBrowserType"),", in this example the iPhone12 uses WebKit."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="deviceDescriptorsSource.json"',title:'"deviceDescriptorsSource.json"'},'"iPhone 12": {\n    "userAgent": "Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.4 Mobile/15E148 Safari/604.1",\n    "screen": {\n      "width": 390,\n      "height": 844\n    },\n    "viewport": {\n      "width": 390,\n      "height": 664\n    },\n    "deviceScaleFactor": 3,\n    "isMobile": true,\n    "hasTouch": true,\n    "defaultBrowserType": "webkit"\n  }\n')),(0,i.kt)("h2",{id:"testing"},"Testing"),(0,i.kt)("h3",{id:"writing-tests"},"Writing tests"),(0,i.kt)("p",null,"When building your playwright tests it helps to have a version of the application deployed for capturing locators and verifying your tests function as intended."),(0,i.kt)("p",null,"You can serve your required application to localhost on port 4200 through the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"nx serve <app-name>\n")),(0,i.kt)("p",null,"NX will then build and host your application, from here you can build/run your tests against a usable version of the application"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-log",metastring:'title="Example"',title:'"Example"'},"nx serve next-app\n\n> nx run next-app:serve:development\n\n  info  - automatically enabled Fast Refresh for 1 custom loader\n  event - compiled client and server successfully in 8.5s (166 modules)\n  [ ready ] on http://localhost:4200\n")),(0,i.kt)("h3",{id:"running-your-playwright-tests"},"Running your playwright tests"),(0,i.kt)("p",null,"Using NX we can very easily run our tests, either for a specific project, or against any affected projects. NX will handle provisioning and tearing down of the web server automatically!\nUsing the NX \u2018affected\u2019 capability allows you to run only the tests within a mono repo where the codebase has changes since the \u2018master\u2019 commit. (See the ",(0,i.kt)("a",{parentName:"p",href:"https://nx.dev/concepts/affected"},"docs")," for more information)"),(0,i.kt)(s.Z,{mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"current",label:"Current",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"nx e2e example-test-project-e2e\n"))),(0,i.kt)(o.Z,{value:"affected",label:"Affected",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"nx affected:e2e\n")))),(0,i.kt)("h4",{id:"run-specific-tests"},"Run specific tests"),(0,i.kt)("p",null,"Looking at the following example, we have tagged the test with ",(0,i.kt)("strong",{parentName:"p"},"@smoke-test")," within the test case name"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"test('App should be up and running @smoke-test', async ({ page }) => {\n    const status: string = await page.locator('#hero >> span').textContent();\n    expect(status).toBe(\"You're up and running\");\n});\n")),(0,i.kt)("p",null,"To run specific this specific test you can use the grep parameter alongside your run command, similarly, if multiple tests contain ",(0,i.kt)("strong",{parentName:"p"},"@smoke-test")," within their name, they will also be executed "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"nx e2e example-test-project-e2e --grep @smoke-test\n")),(0,i.kt)("h2",{id:"testing-output"},"Testing Output"),(0,i.kt)("h3",{id:"viewing-your-test-results"},"Viewing your test results"),(0,i.kt)("p",null,"Playwright has many configuration options for test reporting which can be found in ",(0,i.kt)("a",{parentName:"p",href:"https://playwright.dev/docs/test-reporters"},"the documentation"),"."),(0,i.kt)("h4",{id:"locally"},"Locally"),(0,i.kt)("p",null,"Using the scaffolded ",(0,i.kt)("a",{parentName:"p",href:"#base-configuration"},"base configuration")," all test results will be output to the terminal using Playwrights ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"list"))," reporter, an example output can be seen below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Running 30 tests using 8 workers\n\n  \u2713  3 [chromium] \u203a src\\example.spec.ts:23:3 \u203a Playwright example tests @example-playwright \u203a App should have 5 learning materials (7s)\n  -  4 [chromium] \u203a src\\example.spec.ts:39:3 \u203a Playwright example tests @example-playwright \u203a NX logo should be hidden on mobile\n  \u2713  1 [chromium] \u203a src\\example.spec.ts:11:3 \u203a Playwright example tests @example-playwright \u203a clicking whats next should take the user to the next steps part of the page (7s)\n  \u2713  2 [chromium] \u203a src\\example.spec.ts:18:3 \u203a Playwright example tests @example-playwright \u203a App should be up and running (7s)\n  \u2713  6 [chromium] \u203a src\\example.spec.ts:49:3 \u203a Playwright example tests @example-playwright \u203a NX logo should be visible on desktop (7s)\n  \u2713  5 [chromium] \u203a src\\example.spec.ts:27:3 \u203a Playwright example tests @example-playwright \u203a Clicking next steps should display information (7s)\n  \u2713  7 [firefox] \u203a src\\example.spec.ts:18:3 \u203a Playwright example tests @example-playwright \u203a App should be up and running (7s)\n  \u2713  8 [firefox] \u203a src\\example.spec.ts:11:3 \u203a Playwright example tests @example-playwright \u203a clicking whats next should take the user to the next steps part of the page (7s)\n  \u2713  10 [webkit] \u203a src\\example.spec.ts:11:3 \u203a Playwright example tests @example-playwright \u203a clicking whats next should take the user to the next steps part of the page (8s)\n  \u2713  29 [Mobile Safari] \u203a src\\example.spec.ts:39:3 \u203a Playwright example tests @example-playwright \u203a NX logo should be hidden on mobile (3s)\n  -  30 [Mobile Safari] \u203a src\\example.spec.ts:49:3 \u203a Playwright example tests @example-playwright \u203a NX logo should be visible on desktop\n  \u2713  28 [Mobile Safari] \u203a src\\example.spec.ts:27:3 \u203a Playwright example tests @example-playwright \u203a Clicking next steps should display information (4s)\n\n\n  5 skipped\n  25 passed (55s)\nDone in 56.75s.\n")),(0,i.kt)("p",null,"One recommendation for running locally is to utilise HTML reports, a visual report on the status of all executed tests. When viewing HTML reports, all artefacts such as screenshots can be found in one place, alongside trace reports which are very useful in debugging tests post execution."),(0,i.kt)("p",null,"To change the reporter being used locally you can amend the ",(0,i.kt)("a",{parentName:"p",href:"#project-based-configuration"},(0,i.kt)("inlineCode",{parentName:"a"},"playwright.config.ts"))," or alternatively through the CLI. Through both options you can also enable the ",(0,i.kt)("a",{parentName:"p",href:"https://playwright.dev/docs/trace-viewer-intro"},"trace viewer"),": "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"nx e2e next-js-app-e2e --reporter=html --trace on\n")),(0,i.kt)("h3",{id:"output-in-ci"},"Output in CI"),(0,i.kt)("p",null,"If your test project and application has been scaffolded with infrastructure (",(0,i.kt)("a",{parentName:"p",href:"/docs/getting_started/workspace/ensono-stacks-workspace#generators"},"@ensono-stacks/workspace:init")," and ",(0,i.kt)("a",{parentName:"p",href:"/docs/getting_started/next/ensono-stacks-next#generators"},"@ensono-stacks/next:infrastructure"),") the ",(0,i.kt)("a",{parentName:"p",href:"/docs/getting_started/playwright/ensono-stacks-playwright#generators"},"@ensono-stacks/playwright:init")," generator will add e2e tasks to your taskctl.yaml file."),(0,i.kt)("p",null,"Upon a pull request being made this will automatically trigger a build pipeline for your application whereby the e2e test project will be ran."),(0,i.kt)("p",null,"As defined in the ",(0,i.kt)("a",{parentName:"p",href:"#base-configuration"},"base configuration")," all test artefacts are output to 'test-results/<app-name",">","'"),(0,i.kt)("p",null,"When running in the CI three reporters are utilised:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"dot: Produces a single character per successful test run, keeping detail concise for CI reporting."),(0,i.kt)("li",{parentName:"ol"},"html: A self-contained folder that contains report for the test run that can be served as a web page. Output to 'test-results/<app-name",">","/html-report'."),(0,i.kt)("li",{parentName:"ol"},"junit: A JUnit-style xml report which can be fed back into CI reports on the test run. Output to 'test-results/<app-name",">","/<app-name",">",".xml'")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Build summary:")," You can view a summary of your build by viewing the pipeline which was ran upon pull request creation."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Azure Pipeline Summary",src:n(6963).Z,width:"1617",height:"550"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Test results:")," As part of your generated pipelines test results will be automatically displayed within the summary tab for the build."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Azure Pipeline Test Results",src:n(523).Z,width:"1613",height:"437"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Test artefacts:")," To download the test artefacts captured by playwright select the ",(0,i.kt)("em",{parentName:"p"},"build")," job on the summary page, within the build log click on the 'artefact produced' link, from here you can then download the 'testresults' folder for the test run. "),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Azure Pipeline Build log",src:n(2528).Z,width:"712",height:"588"})),(0,i.kt)("admonition",{title:"HTML Report - Viewing Trace Views",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"When downloading/viewing HTML reports uploaded as test artefacts to your pipeline, you may experience issues opening ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://playwright.dev/docs/trace-viewer"},"trace views"))," as these must be loaded over ",(0,i.kt)("strong",{parentName:"p"},"http://")," or ",(0,i.kt)("strong",{parentName:"p"},"https://")," protocols, we recommend copying the 'testresult' folder into your local workspace and then using ",(0,i.kt)("strong",{parentName:"p"},"npx playwright show-report 'html-report path'")," to serve the report to localhost")))}f.isMDXComponent=!0},2528:function(e,t,n){t.Z=n.p+"assets/images/azure-test-pipeline-build-log-d6de04d0d28894df905577f0a95604d3.png"},6963:function(e,t,n){t.Z=n.p+"assets/images/azure-test-pipeline-summary-7834fca5a2659c2c6c2f56ac449f6518.png"},523:function(e,t,n){t.Z=n.p+"assets/images/azure-test-pipeline-test-results-cb457956d4b16a4367773f1fe704d2a3.png"}}]);