"use strict";(self.webpackChunkstacks=self.webpackChunkstacks||[]).push([[1349],{7398:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>a,toc:()=>l});var i=t(4848),r=t(8453),s=t(6025);const c={id:"pipeline_gha_netcore",title:".NET - GitHub Actions Pipeline",sidebar_label:"AWS/GHA Pipeline",description:"How to configure GitHub Actions Pipeline for .NET",keywords:[".net","github actions","configure","pipeline","setting up","template","build"]},o=void 0,a={id:"workloads/azure/backend/netcore/pipeline_gha_netcore",title:".NET - GitHub Actions Pipeline",description:"How to configure GitHub Actions Pipeline for .NET",source:"@site/docs/workloads/azure/backend/netcore/pipeline_gha_netcore.md",sourceDirName:"workloads/azure/backend/netcore",slug:"/workloads/azure/backend/netcore/pipeline_gha_netcore",permalink:"/docs/workloads/azure/backend/netcore/pipeline_gha_netcore",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"pipeline_gha_netcore",title:".NET - GitHub Actions Pipeline",sidebar_label:"AWS/GHA Pipeline",description:"How to configure GitHub Actions Pipeline for .NET",keywords:[".net","github actions","configure","pipeline","setting up","template","build"]},sidebar:"docs",previous:{title:"AWS Infrastructure",permalink:"/docs/workloads/azure/backend/netcore/infrastructure_aws_netcore"},next:{title:"Logging",permalink:"/docs/workloads/azure/backend/netcore/logging_netcore"}},d={},l=[{value:"Pipeline Diagram",id:"pipeline-diagram",level:2},{value:"Feature branch -&gt; Dev sequence",id:"feature-branch---dev-sequence",level:3},{value:"Main branch -&gt; Production sequence",id:"main-branch---production-sequence",level:3},{value:"Setting up GitHub Actions",id:"setting-up-github-actions",level:2},{value:"Variables",id:"variables",level:3},{value:"Creating the pipeline",id:"creating-the-pipeline",level:3}];function h(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The pipeline will automate provisioning and updating the .NET REST API with CQRS infrastructure in AWS."}),"\n",(0,i.jsx)(n.h2,{id:"pipeline-diagram",children:"Pipeline Diagram"}),"\n",(0,i.jsx)(n.h3,{id:"feature-branch---dev-sequence",children:"Feature branch -> Dev sequence"}),"\n",(0,i.jsx)("img",{alt:"Dev .NET REST API - GitHub Actions Pipeline",src:(0,s.Ay)("img/netcore_pipeline_dev.png")}),"\n",(0,i.jsx)(n.h3,{id:"main-branch---production-sequence",children:"Main branch -> Production sequence"}),"\n",(0,i.jsx)("img",{alt:"Prod .NET REST API - GitHub Actions Pipeline",src:(0,s.Ay)("img/netcore_pipeline_prod.png")}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-github-actions",children:"Setting up GitHub Actions"}),"\n",(0,i.jsx)(n.h3,{id:"variables",children:"Variables"}),"\n",(0,i.jsxs)(n.p,{children:["A variable file located at ",(0,i.jsx)(n.code,{children:".github/workflows/ci-env.yml"})," will contain the majority of the variables required for the pipeline. ",(0,i.jsx)(n.strong,{children:"This file should be manually checked and updated where required before first deployment"}),". If the project was generated using the Stacks CLI then the file will be updated with the information provided."]}),"\n",(0,i.jsxs)(n.p,{children:["Environment secrets will need creating for storing some sensitive variables to be used by the pipeline. Instructions for creating a environment secrets can be found ",(0,i.jsx)(n.a,{href:"https://docs.github.com/en/actions/managing-workflow-runs-and-deployments/managing-deployments/managing-environments-for-deployment#environment-secrets",children:"here"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Add the following secrets:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variable Name"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Required for"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS_ACCESS_KEY_ID"}),(0,i.jsx)(n.td,{children:"AWS IAM User Access Key ID"}),(0,i.jsx)(n.td,{children:"AWS Authentication"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS_ACCOUNT_ID"}),(0,i.jsx)(n.td,{children:"AWS Account ID"}),(0,i.jsx)(n.td,{children:"AWS Authentication"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS_SECRET_ACCESS_KEY"}),(0,i.jsx)(n.td,{children:"AWS IAM User Secret Access Key"}),(0,i.jsx)(n.td,{children:"AWS Authentication"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS_TF_STATE_BUCKET"}),(0,i.jsx)(n.td,{children:"S3 Bucket name for Terraform state"}),(0,i.jsx)(n.td,{children:"Terraform State Management"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS_TF_STATE_DYNAMOTABLE"}),(0,i.jsx)(n.td,{children:"DynamoDB Table name for Terraform state"}),(0,i.jsx)(n.td,{children:"Terraform State Management"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS_TF_STATE_ENCRYPTION"}),(0,i.jsxs)(n.td,{children:["Encrypt Terraform state. ",(0,i.jsx)(n.code,{children:"true"})," or ",(0,i.jsx)(n.code,{children:"false"})]}),(0,i.jsx)(n.td,{children:"Terraform State Management"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS_TF_STATE_KEY"}),(0,i.jsx)(n.td,{children:"Unique name for this applications Terraform state"}),(0,i.jsx)(n.td,{children:"Terraform State Management"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS_TF_STATE_REGION"}),(0,i.jsx)(n.td,{children:"AWS region"}),(0,i.jsx)(n.td,{children:"Terraform State Management"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"creating-the-pipeline",children:"Creating the pipeline"}),"\n",(0,i.jsxs)(n.p,{children:["Stacks generates the GitHub Actions workflow file in the directory expected by GitHub Actions, ",(0,i.jsx)(n.code,{children:".github/workflows"}),". Committing this file to the ",(0,i.jsx)(n.code,{children:"main"}),' branch of a GitHub repository will "create" the pipeline. Instructions for viewing the results can be found ',(0,i.jsx)(n.a,{href:"https://docs.github.com/en/actions/writing-workflows/quickstart#viewing-your-workflow-results",children:"here"})]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var i=t(6540);const r={},s=i.createContext(r);function c(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);