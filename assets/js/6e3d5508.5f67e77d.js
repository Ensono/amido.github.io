"use strict";(self.webpackChunkstacks=self.webpackChunkstacks||[]).push([[6422],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return g}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=s(n),m=r,g=c["".concat(p,".").concat(m)]||c[m]||d[m]||o;return n?a.createElement(g,i(i({ref:t},u),{},{components:n})):a.createElement(g,i({ref:t},u))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8597:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return p},default:function(){return g},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return c}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],l={},p=void 0,s={unversionedId:"getting_started/next/next-auth",id:"getting_started/next/next-auth",title:"next-auth",description:"@ensono-stacks/next:next-auth",source:"@site/docs/getting_started/next/next-auth.md",sourceDirName:"getting_started/next",slug:"/getting_started/next/next-auth",permalink:"/docs/getting_started/next/next-auth",draft:!1,tags:[],version:"current",frontMatter:{}},u={},c=[{value:"@ensono-stacks/next:next-auth",id:"ensono-stacksnextnext-auth",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Usage",id:"usage",level:2},{value:"Command line arguments",id:"command-line-arguments",level:3},{value:"Generator Output",id:"generator-output",level:3}],d={toc:c},m="wrapper";function g(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"ensono-stacksnextnext-auth"},"@ensono-stacks/next:next-auth"),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Add Next Authentication to your next application"),(0,o.kt)("p",null,"The next-auth generator will install and configure ",(0,o.kt)("a",{parentName:"p",href:"https://next-auth.js.org/"},"NextAuth.js")," into an existing Next application. It will add the initial configuration, add the session provider, setup an API endpoint and add local environmental variables. It will also configure provider specific setup."),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("p",null,"An existing ",(0,o.kt)("a",{parentName:"p",href:"https://nextjs.org/"},"Next")," application"),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nx g @ensono-stacks/next:next-auth\n")),(0,o.kt)("h3",{id:"command-line-arguments"},"Command line arguments"),(0,o.kt)("p",null,"The following command line arguments are available:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Option"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Accepted Values"),(0,o.kt)("th",{parentName:"tr",align:null},"Default"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"--project"),(0,o.kt)("td",{parentName:"tr",align:null},"The name of the project"),(0,o.kt)("td",{parentName:"tr",align:null},"nameOfApplication"),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},"N/A")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"--provider"),(0,o.kt)("td",{parentName:"tr",align:null},"The provider to be installed"),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},"none/azureAd"),(0,o.kt)("td",{parentName:"tr",align:null},"none")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"--skipPackageJson"),(0,o.kt)("td",{parentName:"tr",align:null},"Do not add dependencies to ",(0,o.kt)("inlineCode",{parentName:"td"},"package.json")),(0,o.kt)("td",{parentName:"tr",align:null},"boolean"),(0,o.kt)("td",{parentName:"tr",align:null},"true/false"),(0,o.kt)("td",{parentName:"tr",align:null},"false")))),(0,o.kt)("h3",{id:"generator-output"},"Generator Output"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Creates a new Next API endpoint with the file name ",(0,o.kt)("inlineCode",{parentName:"li"},"[...nextauth].ts"),". This contains the dynamic route handler for NextAuth.js which will also contain all of your global NextAuth.js configurations. If you have specified a provider when running the generator this will be added to the providers array")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="/apps/appName/pages/api/[...nextauth].ts"',title:'"/apps/appName/pages/api/[...nextauth].ts"'},"import NextAuth from 'next-auth';\nimport AzureADProvider from 'next-auth/providers/azure-ad';\nconst nextAuth = NextAuth({\n  providers: [\n    AzureADProvider({\n      clientId: process.env.AZURE_AD_CLIENT_ID,\n      clientSecret: process.env.AZURE_AD_CLIENT_SECRET,\n      tenantId: process.env.AZURE_AD_TENANT_ID,\n    }),\n  ],\n});\nexport default nextAuth;\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Install the next-auth package and add to package.json, unless the ",(0,o.kt)("inlineCode",{parentName:"li"},"--skipPackageJson")," option was used")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="/package.json"',title:'"/package.json"'},'"dependencies": {\n    ...otherDependencies\n    "next-auth": "4.18.8",\n},\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create or append an ",(0,o.kt)("inlineCode",{parentName:"li"},".env.local")," file. Adding required next auth environmental variables. These will vary depending on the provider chosen. ")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="/.env.local"',title:'"/.env.local"'},"NEXTAUTH_URL=http://localhost:4200\nNEXTAUTH_SECRET=secretValue\nAZURE_AD_CLIENT_ID=\nAZURE_AD_CLIENT_SECRET=\nAZURE_AD_TENANT_ID=\n")),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Be sure to update the environmental variables with the values provided by your provider")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Append the ",(0,o.kt)("inlineCode",{parentName:"li"},"_app.tsx")," file with a ",(0,o.kt)("a",{parentName:"li",href:"https://next-auth.js.org/getting-started/client#sessionprovider"},"session provider")," ")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="/apps/appName/_app.tsx"',title:'"/apps/appName/_app.tsx"'},"import { AppProps } from 'next/app';\nimport Head from 'next/head';\nimport './styles.css';\nimport { SessionProvider } from 'next-auth/react';\nfunction CustomApp({\n  Component,\n  pageProps: { session, ...pageProps },\n}: AppProps) {\n  return (\n    <SessionProvider session={session}>\n      <Head>\n        <title>Welcome to testing!</title>\n      </Head>\n      <main className=\"app\">\n        <Component {...pageProps} />\n      </main>\n    </SessionProvider>\n  );\n}\nexport default CustomApp;\n")),(0,o.kt)("p",null,"From here with the configuration complete it is now possible to access the ",(0,o.kt)("a",{parentName:"p",href:"https://next-auth.js.org/getting-started/client#usesession"},"useSession")," hook from next auth. For further information please see the ",(0,o.kt)("a",{parentName:"p",href:"https://next-auth.js.org/getting-started/example#frontend---add-react-hook"},"Getting Started Guide to Next Auth"))))}g.isMDXComponent=!0}}]);