<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<title data-react-helmet="true">Testing - Static Code Analysis | Amido Stacks</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Testing - Static Code Analysis | Amido Stacks"><meta data-react-helmet="true" name="description" content="We are using SonarQube for static analysis. To enable integrations with GitHub and for use in Azure DevOps CI, the results are then hosted and viewable on SonarCloud."><meta data-react-helmet="true" property="og:description" content="We are using SonarQube for static analysis. To enable integrations with GitHub and for use in Azure DevOps CI, the results are then hosted and viewable on SonarCloud."><meta data-react-helmet="true" property="og:url" content="https://amido.github.io/stacks/docs/testing/testing_static"><link data-react-helmet="true" rel="shortcut icon" href="/stacks/img/thumbnail_stacks.png"><link data-react-helmet="true" rel="canonical" href="https://amido.github.io/stacks/docs/testing/testing_static"><link rel="stylesheet" href="/stacks/styles.addbe53e.css">
<link rel="preload" href="/stacks/styles.d53f3d97.js" as="script">
<link rel="preload" href="/stacks/runtime~main.742b5974.js" as="script">
<link rel="preload" href="/stacks/main.7fe40356.js" as="script">
<link rel="preload" href="/stacks/1.46f0865d.js" as="script">
<link rel="preload" href="/stacks/2.4d32b683.js" as="script">
<link rel="preload" href="/stacks/3.ed43ef59.js" as="script">
<link rel="preload" href="/stacks/1be78505.83434592.js" as="script">
<link rel="preload" href="/stacks/85.b2a675a0.js" as="script">
<link rel="preload" href="/stacks/935f2afb.3497cf91.js" as="script">
<link rel="preload" href="/stacks/17896441.565d2c6a.js" as="script">
<link rel="preload" href="/stacks/85a306f5.31d1a4c5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/stacks/"><img class="navbar__logo" src="/stacks/img/logo.svg" alt="Amido Stacks Logo"><strong class="navbar__title">Amido Stacks</strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/stacks/docs/">Docs</a><a href="https://github.com/amido/stacks" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/stacks/"><img class="navbar__logo" src="/stacks/img/logo.svg" alt="Amido Stacks Logo"><strong class="navbar__title">Amido Stacks</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/stacks/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/amido/stacks" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/">About Amido Stacks</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Build the application</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/getting_started_demo">Using the scaffolding-cli to build an application</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Workloads</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/workloads">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Azure</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Frontend Web Applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/frontend/intro_node_js">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/frontend/ide_node_js">IDE Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/frontend/environment_variables_nodejs">Enviroment Variables</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/frontend/cli_webapp_frameworks">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/frontend/monorepo">Stacks Monorepo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/frontend/browser_support">Browser Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/frontend/server_side_cache">Server Side Cache</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Backend Services</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Java Spring Boot REST API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java/intro_java">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java/quickstart_java">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java/scaffolding_java">Using the Scaffolding CLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java/ide_java">IDE guidelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java/testing_java">Testing the application</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Architecture</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java/architecture_java">Architecture overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java/structure_java">Project structure</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Java Spring Boot REST API with CQRS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java_cqrs/intro_java_cqrs">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java_cqrs/quickstart_java_cqrs">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java_cqrs/scaffolding_java_cqrs">Using the Scaffolding CLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java_cqrs/ide_java_cqrs">IDE guidelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java_cqrs/testing_java_cqrs">Testing the application</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Architecture</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java_cqrs/architecture_java_cqrs">Architecture overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/java_cqrs/structure_java_cqrs">Project structure</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">.NET Core REST API with CQRS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/introduction_netcore">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/requirements_netcore">Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/create_project_netcore">Create the project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/configure_project_netcore">Configure the project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/build_and_run_project_netcore">Build &amp; Run the Project</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Test</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/testing/functional_testing_netcore">Functional testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/testing/performance_testing_netcore">Performance testing</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/deploy_project_netcore">Deployment</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Swagger Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/swagger_configuration/configure_swagger_netcore">Swagger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/quickstart/swagger_configuration/configure_swagger_ui_netcore">Swagger UI</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/logging_netcore">Logging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/security_netcore">Security</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Architecture</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/project_structure/architecture_overview_netcore">Architecture Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/project_structure/repository_overview_netcore">Repository</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/azure/backend/netcore/project_structure/project_structure_netcore">Solution Structure</a></li></ul></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Google Cloud Platform</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/gcp/workloads_gcp_readme">Workloads on GCP</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Amazon Web Services</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/workloads/aws/workloads_aws_readme">Workloads on AWS</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Infrastructure</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Azure</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/infrastructure/azure/infrastructure_code">Infrastructure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/stacks/docs/infrastructure/azure/pipeline_templates">Pipeline Templates</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Testing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/stacks/docs/testing/testing">Testing and quality</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/stacks/docs/testing/cli_testing_frameworks">Project Types - Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/stacks/docs/testing/testing_serenity_bdd">E2E Serenity BDD Java</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/stacks/docs/testing/testing_static">Static Code Analysis</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Testing - Static Code Analysis</h1></header><div class="markdown"><p>We are using <a href="https://docs.sonarqube.org/" target="_blank" rel="noopener noreferrer">SonarQube</a> for static analysis. To enable integrations with GitHub and for use in Azure DevOps CI, the results are then hosted and viewable on <a href="https://sonarcloud.io/" target="_blank" rel="noopener noreferrer">SonarCloud</a>.</p><p>SonarCloud offers quality gates that ensure that your standards are adhered to before deploying.</p><p> <img src="https://amidostacksassets.blob.core.windows.net/docs/assets/sonarcloud_overview.png" alt="sonarcloud_example">
<img src="https://amidostacksassets.blob.core.windows.net/docs/assets/sonarcloud_github.png" alt="sonarcloud_github"></p><p>SonarCloud supports most languages.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="getting-started"></a>Getting started<a aria-hidden="true" tabindex="-1" class="hash-link" href="#getting-started" title="Direct link to heading">#</a></h2><p>Sign up with GitHub to <a href="https://sonarcloud.io" target="_blank" rel="noopener noreferrer">Sonarcloud</a> for the Organisation under test. Review the documentation and setup on how to plugin to GitHub.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-jest-with-sonarcloud"></a>Using Jest with SonarCloud<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-jest-with-sonarcloud" title="Direct link to heading">#</a></h2><p>SonarCloud collects the coverage reports generated by Jest in the form of <code>lcov.info</code> output. Configuration in the <code>jest.config.json</code> file will include the following for code coverage collection.</p><p>‚ö†Ô∏è IMPORTANT: To ensure that the <code>lcov.info</code> reports with <em>relative paths</em> the root  <code>&quot;roots&quot;: [&quot;&lt;rootDir&gt;/.&quot;]</code> needs to be set. Else then the <code>lcov</code> report will embed the root directory in the path, and sonar scanner won&#x27;t be able to map the coverage to the analysed files.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token property">&quot;roots&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;rootDir&gt;/.&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token property">&quot;coverageReporters&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cobertura&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lcov&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;collectCoverage&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;collectCoverageFrom&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;**/*.{ts,tsx}&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;!**/*.test.*&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;!&lt;rootDir&gt;/.*&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;!**/*config.{js,json}&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;!&lt;rootDir&gt;/coverage&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;!&lt;rootDir&gt;/__tests__/**/*&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;!&lt;rootDir&gt;/__mocks__/**/*&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;coverageDirectory&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;rootDir&gt;/coverage/&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;coverageThreshold&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;global&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;statements&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;branches&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;functions&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;lines&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>The coverage directory will be where the <code>lcov</code> reports are generated.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="configuring-sonarcloud"></a>Configuring SonarCloud<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuring-sonarcloud" title="Direct link to heading">#</a></h2><p>At the root of the package, a <code>sonar-project.properties</code> configuration file can be created, to pull in the required SonarCloud environment variables, including SonarCloud token, project name, where to collect the code coverage report from, and what files should be excluded from analysis.</p><p>For all configuration options see <a href="https://sonarcloud.io/documentation/analysis/analysis-parameters/" target="_blank" rel="noopener noreferrer">SonarCloud Analysis Parameters</a>.</p><p>To pull in the Jest generated code coverage reports, outputted in the SonarCloud supported <code>lcov.info</code> report, the report path can be set in the <code>sonar-project.properties</code> file:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># sonar-project.properties</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sonar.javascript.lcov.reportPaths</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">coverage/lcov.info</span></div></div></div></div></div><p>To ensure that SonarCloud doesn&#x27;t analysis files that are not needed for analysis, please exclude them:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># sonar-project.properties</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sonar.exclusions</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">node_modules/**/*, dist/**/*, coverage/**/*, **/*.test.*, *.config.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">js,json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">, __tests__/**/*, __mocks__/**/*, ./.*, *.xml, **/*.d.*, **/*.js</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="amidostacksci-sonarscanner"></a>amidostacks/ci-sonarscanner<a aria-hidden="true" tabindex="-1" class="hash-link" href="#amidostacksci-sonarscanner" title="Direct link to heading">#</a></h2><p>We can run this with Amido Stacks custom container, supports running Sonar Scanner for .NET and NPM projects.</p><p>See <a href="https://hub.docker.com/repository/docker/amidostacks/ci-sonarscanner" target="_blank" rel="noopener noreferrer">amidostacks/ci-sonarscanner</a> for the open source image.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="static-quality-gates"></a>Static quality gates<a aria-hidden="true" tabindex="-1" class="hash-link" href="#static-quality-gates" title="Direct link to heading">#</a></h2><p>To ensure that all code is meeting the quality standards (i.e. code coverage, bugs, security) then we can implement Quality gate checks from the results of the SonarScanner analysis.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="azure-pipelines"></a>Azure pipelines<a aria-hidden="true" tabindex="-1" class="hash-link" href="#azure-pipelines" title="Direct link to heading">#</a></h3><p>‚ö†Ô∏è IMPORTANT: The <code>amidostacks/ci-sonarscanner</code> does not fail the pipeline if the quality gate is not passed on SonarCloud. We recommend following one of these implementations:</p><ul><li><p><a href="https://docs.sonarqube.org/latest/analysis/scan/sonarscanner-for-azure-devops/" target="_blank" rel="noopener noreferrer">SonarScanner for Azure Devops</a> or your current pipeline</p><ul><li>Example usage in the open-source <a href="https://github.com/amido/stacks-pipeline-templates/blob/831c46811abfeff30833ccb003305692cb7ad2af/azDevOps/azure/templates/jobs/build-dotnet.yml" target="_blank" rel="noopener noreferrer">build-dotnet.yml</a> template step</li></ul></li><li><p>Using <a href="https://www.sonarlint.org" target="_blank" rel="noopener noreferrer">SonarLint as an IDE extension</a> that helps you detect and fix quality issues as you write code.</p><ul><li>See <code>[example workspace settings](../.vscode/settings.json)</code></li></ul></li><li><p>Using <a href="https://hub.docker.com/repository/docker/amidostacks/ci-sonarscanner" target="_blank" rel="noopener noreferrer">amidostacks/ci-sonarscanner</a></p></li><li><p><a href="https://github.com/SonarSource/sonarcloud-github-action" target="_blank" rel="noopener noreferrer">Github Actions with SonarCloud</a> to automatically run analysis triggered by Github</p></li></ul><p>Another option is to have a task running using the container, making static code analysis a breeze in the pipelines and easy to run locally. For an example on how to use the container to run you static code analysis, see <a href="https://github.com/amido/stacks-pipeline-templates/blob/feature/cycle2/azDevOps/azure/templates/v2/steps/test-static-code-sonar.yml" target="_blank" rel="noopener noreferrer">amido/stacks-pipeline-templates</a></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">bash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">|</span><span class="token scalar string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token scalar string" style="color:rgb(195, 232, 141)">      sonar-scanner -v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token scalar string" style="color:rgb(195, 232, 141)">      sonar-scanner</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">displayName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Static Analysis: SonarScanner Run&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">container</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sonar_scanner</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">SONAR_HOST_URL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//sonarcloud.io</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">SONAR_TOKEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> $SONAR_TOKEN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">SONAR_PROJECT_KEY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> $SONAR_PROJECT_KEY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">SONAR_ORGANIZATION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> $SONAR_ORGANIZATION</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">BUILD_NUMBER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> $(Build.BuildNumber)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">workingDirectory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> parameters.workingDirectory </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="running-locally"></a>Running locally<a aria-hidden="true" tabindex="-1" class="hash-link" href="#running-locally" title="Direct link to heading">#</a></h3><p>In order to run, the export the followings environment variables for the
SonarCloud Project:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SONAR_TOKEN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SONAR_PROJECT_KEY</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SONAR_ORGANIZATION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">BUILD_NUMBER</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span></div></div></div></div></div><p>First generate the code coverage results but running the unit tests, then run the SonarCloud scanner and
push up the results for analysis.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">test</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SONAR_HOST_URL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">https://sonarcloud.io -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SONAR_TOKEN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$SONAR_TOKEN</span><span class="token plain"> -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SONAR_PROJECT_KEY</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$SONAR_PROJECT_KEY</span><span class="token plain"> -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SONAR_ORGANIZATION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$SONAR_ORGANIZATION</span><span class="token plain"> -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">BUILD_NUMBER</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1.2</span><span class="token plain">.3 -v </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">pwd</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain">:/usr/src --rm -it amidostacks/ci-sonarscanner /bin/bash -c </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cd /usr/src &amp;&amp; sonar-scanner&#x27;</span></div></div></div></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/stacks/docs/testing/testing_serenity_bdd"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Testing - End to End Automation with Serenity BDD Java</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started" class="table-of-contents__link">Getting started</a></li><li><a href="#using-jest-with-sonarcloud" class="table-of-contents__link">Using Jest with SonarCloud</a></li><li><a href="#configuring-sonarcloud" class="table-of-contents__link">Configuring SonarCloud</a></li><li><a href="#amidostacksci-sonarscanner" class="table-of-contents__link">amidostacks/ci-sonarscanner</a></li><li><a href="#static-quality-gates" class="table-of-contents__link">Static quality gates</a><ul><li><a href="#azure-pipelines" class="table-of-contents__link">Azure pipelines</a></li><li><a href="#running-locally" class="table-of-contents__link">Running locally</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/stacks/docs/">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">About Us</h4><ul class="footer__items"><li class="footer__item"><a href="https://amido.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Amido</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Open Source</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/amido/stacks" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright ¬© 2020 Amido Ltd</div></div></div></footer></div>
<script src="/stacks/styles.d53f3d97.js"></script>
<script src="/stacks/runtime~main.742b5974.js"></script>
<script src="/stacks/main.7fe40356.js"></script>
<script src="/stacks/1.46f0865d.js"></script>
<script src="/stacks/2.4d32b683.js"></script>
<script src="/stacks/3.ed43ef59.js"></script>
<script src="/stacks/1be78505.83434592.js"></script>
<script src="/stacks/85.b2a675a0.js"></script>
<script src="/stacks/935f2afb.3497cf91.js"></script>
<script src="/stacks/17896441.565d2c6a.js"></script>
<script src="/stacks/85a306f5.31d1a4c5.js"></script>
</body>
</html>