<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-EKCQBC5CSJ","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EKCQBC5CSJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EKCQBC5CSJ",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Amido Stacks " href="/opensearch.xml"><title data-react-helmet="true">Data Ingest Workloads | Amido Stacks </title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://stacks.amido.com/docs/workloads/azure/data/etl_pipelines/ingest_data_azure"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Data Ingest Workloads | Amido Stacks "><meta data-react-helmet="true" name="description" content="Data Ingest Workloads"><meta data-react-helmet="true" property="og:description" content="Data Ingest Workloads"><meta data-react-helmet="true" name="keywords" content="ingest,adf,etl"><link data-react-helmet="true" rel="shortcut icon" href="/img/thumbnail_stacks.png"><link data-react-helmet="true" rel="canonical" href="https://stacks.amido.com/docs/workloads/azure/data/etl_pipelines/ingest_data_azure"><link data-react-helmet="true" rel="alternate" href="https://stacks.amido.com/docs/workloads/azure/data/etl_pipelines/ingest_data_azure" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://stacks.amido.com/docs/workloads/azure/data/etl_pipelines/ingest_data_azure" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.8807cd65.css">
<link rel="preload" href="/assets/js/runtime~main.058a9182.js" as="script">
<link rel="preload" href="/assets/js/main.3ab9e8d5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo_wide.svg" alt="Amido Stacks Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo_wide.svg" alt="Amido Stacks Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a href="https://github.com/amido/amido.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_NKBi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Learn about Stacks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development Support</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Workloads</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/workloads">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Common</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Azure</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Frontend Web Applications</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Backend Services</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Data Platform</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/intro_data_azure">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/requirements_data_azure">Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/infrastructure_data_azure">Infrastructure</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">ETL Pipelines</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/etl_pipelines/etl_intro_data_azure">ETL Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/workloads/azure/data/etl_pipelines/ingest_data_azure">Data Ingest Workloads</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/etl_pipelines/data_processing">Data Processing Workloads</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/etl_pipelines/data_quality_azure">Data Quality</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/etl_pipelines/datastacks">Datastacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/etl_pipelines/pysparkle">PySparkle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/etl_pipelines/testing_data_azure">Testing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/data/security_data_azure">Security</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Google Cloud Platform</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Amazon Web Services</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Infrastructure</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quality Assurance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Stacks CLI</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Data Ingest Workloads</h1></header><p>Data ingest workloads in Stacks are jobs which:</p><ol><li>Connect to an external data source</li><li>Land the data in the Bronze (raw) layer of the data lake</li></ol><p>Data ingest workloads utilise <a href="https://learn.microsoft.com/en-us/azure/data-factory/connector-overview" target="_blank" rel="noopener noreferrer">Azure Data Factory&#x27;s inbuilt connectors</a> and <a href="https://learn.microsoft.com/en-us/azure/data-factory/copy-activity-overview" target="_blank" rel="noopener noreferrer">Copy activity</a>, to give the ability to easily ingest data from a wide range of data sources. The ingest process is designed around reusable, metadata-driven pipelines. This means once
an initial data pipeline is created for a given data source, additional entities from the same data source can be added or modified just by updating a configuration file.</p><p>Data ingest workloads may also optionally include a <a href="/docs/workloads/azure/data/etl_pipelines/data_quality_azure">Data Quality validations</a> step, executed in Databricks.</p><p>The solution contains a the following example data ingest workloads:</p><ul><li><a href="https://github.com/ensono/stacks-azure-data/tree/main/de_workloads/ingest/Ingest_AzureSql_Example" target="_blank" rel="noopener noreferrer">Ingest_AzureSql_Example</a>: Ingests data from the <a href="/docs/workloads/azure/data/getting_started/example_data_source">example Azure SQL source</a> and lands data into the data lake Bronze layer.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="pipeline-overview">Pipeline overview<a aria-hidden="true" class="hash-link" href="#pipeline-overview" title="Direct link to heading">â€‹</a></h2><p>The diagram below gives an overview of the ingestion pipeline design.</p><p><img alt="ADF_IngestPipelineDesign.png" src="/assets/images/ADF_IngestPipelineDesign-1c61616f6fb3baa0101682c3e522412d.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="configuration">Configuration<a aria-hidden="true" class="hash-link" href="#configuration" title="Direct link to heading">â€‹</a></h2><p>The configuration files for the workload are
stored in the pipeline&#x27;s <a href="https://github.com/ensono/stacks-azure-data/tree/main/de_workloads/ingest/Ingest_AzureSql_Example/config" target="_blank" rel="noopener noreferrer">config</a> directory.</p><p>JSON format is used for the configuration files. Our blueprint includes a sample configuration definition for the data ingestion sources
(<a href="https://github.com/ensono/stacks-azure-data/blob/main/de_workloads/ingest/Ingest_AzureSql_Example/config/ingest_sources/Ingest_AzureSql_Example.json" target="_blank" rel="noopener noreferrer">Ingest_AzureSql_Example.json</a>)
and its schema (<a href="https://github.com/ensono/stacks-azure-data/blob/main/de_workloads/ingest/Ingest_AzureSql_Example/config/schema/ingest_config_schema.json" target="_blank" rel="noopener noreferrer">ingest_config_schema.json</a>).</p><p>The sample ingest pipeline is based around an Azure SQL data source, however the approach used should be adaptable for most other data source types with minimal modifications. Different data data source types would be expected to have the same JSON keys, except for under <code>ingest_entities</code>,
where different keys will be required dependent on the data source type.</p><p>See the descriptions of the example JSON config file below:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;data_source_name&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;example_azuresql_1&quot;</span><span class="token plain">,  </span><span class="token comment" style="color:#999988;font-style:italic"># Identifier of the data source - must be unique</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;data_source_type&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;azure_sql&quot;</span><span class="token plain">,           </span><span class="token comment" style="color:#999988;font-style:italic"># Data source type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;enabled&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true,                           </span><span class="token comment" style="color:#999988;font-style:italic"># Boolean flag to enable / disable the data source from being ingested</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;ingest_entities&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># Array of entities to be ingested from the source</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;version&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">,                      </span><span class="token comment" style="color:#999988;font-style:italic"># Version number - increment this if the entity&#x27;s schema changes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;display_name&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SalesLT.Product&quot;</span><span class="token plain">, </span><span class="token comment" style="color:#999988;font-style:italic"># Name to identify the entity - must be unique per data source</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;enabled&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true,                   </span><span class="token comment" style="color:#999988;font-style:italic"># Boolean flag to enable / disable the entity from being ingested</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;schema&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SalesLT&quot;</span><span class="token plain">,               </span><span class="token comment" style="color:#999988;font-style:italic"># (SQL sources only) Database schema</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;table&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Product&quot;</span><span class="token plain">,                </span><span class="token comment" style="color:#999988;font-style:italic"># (SQL sources only) Database table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;columns&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token plain">,                    </span><span class="token comment" style="color:#999988;font-style:italic"># (SQL sources only) Columns to select. May also contain SQL-expressions for columns.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;load_type&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;delta&quot;</span><span class="token plain">,              </span><span class="token comment" style="color:#999988;font-style:italic"># (SQL sources only) Full or delta load. If delta load selected, then also include the following keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;delta_date_column&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ModifiedDate&quot;</span><span class="token plain">,  </span><span class="token comment" style="color:#999988;font-style:italic"># (SQL sources only, delta load) Date column to use for filtering the date range. May also contain SQL-expressions for columns.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;delta_upsert_key&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SalesOrderID&quot;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (SQL sources only, delta load) Primary key for determining updated columns in a delta load. May also contain SQL-expressions for columns.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>These configuration files will be referenced each time an ingestion pipeline
is triggered in Data Factory, and all entities will be ingested. To disable a particular ingest
source or entity without removing it, you can set <code>&quot;enabled&quot;: false</code> â€“ these will be ignored by
the Data Factory pipeline.</p><p><a href="https://github.com/ensono/stacks-azure-data/tree/main/de_workloads/ingest/Ingest_AzureSql_Example/tests/unit" target="_blank" rel="noopener noreferrer">Unit tests</a>
are provided to ensure the config files remain valid against the schema.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="query-generation">Query generation<a aria-hidden="true" class="hash-link" href="#query-generation" title="Direct link to heading">â€‹</a></h3><p>Values from the config will be used to generate the logic for extracting from the data source. For an Azure SQL data source, an SQL query would be generated for each ingest_entity as follows:</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="full-load">Full load<a aria-hidden="true" class="hash-link" href="#full-load" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI sql"><pre tabindex="0" class="prism-code language-sql codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> {</span><span class="token keyword" style="color:#00009f">columns</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> {</span><span class="token keyword" style="color:#00009f">schema</span><span class="token plain">}</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">{</span><span class="token keyword" style="color:#00009f">table</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="delta-load">Delta load<a aria-hidden="true" class="hash-link" href="#delta-load" title="Direct link to heading">â€‹</a></h4><p>Note: <code>run_window_start_date</code> and <code>run_window_end_date</code> are determined by the values passed at runtime, e.g. by the <a href="#data-factory-triggers">tumbling window trigger</a>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI sql"><pre tabindex="0" class="prism-code language-sql codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> {</span><span class="token keyword" style="color:#00009f">columns</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> {</span><span class="token keyword" style="color:#00009f">schema</span><span class="token plain">}</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">{</span><span class="token keyword" style="color:#00009f">table</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> {delta_date_column} </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> {run_window_start_date}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> {delta_date_column} </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> {run_window_end_date}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="data-factory-pipeline-design">Data Factory pipeline design<a aria-hidden="true" class="hash-link" href="#data-factory-pipeline-design" title="Direct link to heading">â€‹</a></h2><p>The provided sample pipelines give an example of a data ingest process from source to the data lake.
The pipelines folder is structured as follows:</p><p><img alt="ADF_IngestPipelinesList.png" src="/assets/images/ADF_IngestPipelinesList-e62d3f121f131951eb307ac286be4129.png"></p><ul><li><code>Ingest</code> contains ingest pipelines specific to the given data source. The naming convention for
these pipelines is <code>Ingest_{SourceType}_{SourceName}</code>. These are the parent pipelines that would be
triggered on a recurring basis to ingest from a data source. All pipelines have their equivalents
that include Data Quality validations. Depending on your particular needs, you can deploy each of
the pipelines with or without this additional Data Quality step. <a href="/docs/workloads/azure/data/etl_pipelines/data_quality_azure">Further information on Data Quality</a>.</li><li>The pipelines within <code>Utilities</code> are reusable and referenced by other pipelines. They are not
meant to be triggered independently. These are defined within the <a href="https://github.com/ensono/stacks-azure-data/tree/main/de_workloads/shared_resources" target="_blank" rel="noopener noreferrer">shared_resources</a> for the project.</li></ul><p>The <code>Ingest_AzureSql_Example</code> pipeline consists of the following steps:</p><p><img alt="ADF_Ingest_AzureSql_Example.png" src="/assets/images/ADF_Ingest_AzureSql_Example-66feb8518733339a00c4fa1aa4e0784b.png"></p><ol><li><code>Get_Ingest_Config</code>: Calls the utility pipeline, passing the data source name as a parameter.
This will return the configuration required for the given data source.</li><li><code>For_Each_Ingest_Entity</code>: Loop through each ingest entity performing the following steps:<ol><li><code>Generate_Ingest_Query</code>: Generates a SQL query to extract the data from a required time range,
according to the provided configuration. Depending on the load type, one of the two scenarios
below will be applied:<ul><li>Full extraction loads all available data for a given set of columns,</li><li>Delta queries contain a <code>WHERE</code> clause to restrict the date range loaded.</li></ul></li><li><code>SQL_to_ADLS</code>: Execute the SQL query against the data source, and copy the results to the
Azure Data Lake storage landing container under the appropriate path (data is validated using
ADF&#x27;s built-in data validation capability).</li></ol></li></ol><p>The following picture shows the two possibilities of full vs delta extraction in <code>Generate_Ingest_Query</code>:</p><p><img alt="ADF_IngestGenerateIngestQuery.png" src="/assets/images/ADF_IngestGenerateIngestQuery-875a13c99e0cd363046554d3c37182d0.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="data-factory-triggers">Data Factory triggers<a aria-hidden="true" class="hash-link" href="#data-factory-triggers" title="Direct link to heading">â€‹</a></h3><p>An example Data Factory pipeline trigger is provided and associated to the ingest pipeline. Triggers can be viewed in the Data Factory UI through Manage &gt; Triggers.</p><p>The example triggers utilise the <a href="https://learn.microsoft.com/en-us/azure/data-factory/how-to-create-tumbling-window-trigger?tabs=data-factory" target="_blank" rel="noopener noreferrer">tumbling window trigger</a> type. A tumbling window is a continuous and non-overlapping time interval. It allows reliable incremental data ingestion and, in Data Factory, allows re-running of specific windows later if an error happens and ensures that no data will be lost.</p><p>The trigger can be setup to any granularity down to 5 minutes. Every time it triggers a pipeline, it automatically passes the windowStart and windowEnd parameters for the relevant time window.
If any kind of incident happens, the missing or failed time windows will run retroactively as soon as possible, either sequentially or in parallel (following the Max concurrency option). The benefit of this behaviour it that it guaranties that no time windows are lost or forgotten even if ran days later. Data Factory allows us to re-run individual time windows at will, even if they succeeded.</p><p>Other types of Data Factory triggers are available, including schedule or event-based - these may be utilised dependent on your requirements.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/workloads/azure/data/etl_pipelines/etl_intro_data_azure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->ETL Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/workloads/azure/data/etl_pipelines/data_processing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Data Processing Workloads<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pipeline-overview" class="table-of-contents__link toc-highlight">Pipeline overview</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#query-generation" class="table-of-contents__link toc-highlight">Query generation</a></li></ul></li><li><a href="#data-factory-pipeline-design" class="table-of-contents__link toc-highlight">Data Factory pipeline design</a><ul><li><a href="#data-factory-triggers" class="table-of-contents__link toc-highlight">Data Factory triggers</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs">Getting Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">About Us</div><ul class="footer__items"><li class="footer__item"><a href="https://amido.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Amido<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Open Source</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/amido/amido.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Amido Ltd</div></div></div></footer></div>
<script src="/assets/js/runtime~main.058a9182.js"></script>
<script src="/assets/js/main.3ab9e8d5.js"></script>
</body>
</html>