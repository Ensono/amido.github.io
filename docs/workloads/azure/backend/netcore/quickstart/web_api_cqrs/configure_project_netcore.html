<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-EKCQBC5CSJ","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EKCQBC5CSJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EKCQBC5CSJ",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Amido Stacks " href="/opensearch.xml"><title data-react-helmet="true">Configure REST API with CQRS project | Amido Stacks </title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://stacks.amido.com/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/configure_project_netcore"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Configure REST API with CQRS project | Amido Stacks "><meta data-react-helmet="true" name="description" content="Configure, Build and run .NET Core REST API application with CQRS on local and docker container"><meta data-react-helmet="true" property="og:description" content="Configure, Build and run .NET Core REST API application with CQRS on local and docker container"><meta data-react-helmet="true" name="keywords" content=".net core,rest api,cqrs,azure,application insights,cosmos db,aws sns,build,run,application,configure,docker"><link data-react-helmet="true" rel="shortcut icon" href="/img/thumbnail_stacks.png"><link data-react-helmet="true" rel="canonical" href="https://stacks.amido.com/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/configure_project_netcore"><link data-react-helmet="true" rel="alternate" href="https://stacks.amido.com/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/configure_project_netcore" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://stacks.amido.com/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/configure_project_netcore" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.f0d040b2.css">
<link rel="preload" href="/assets/js/runtime~main.20fb541c.js" as="script">
<link rel="preload" href="/assets/js/main.07ebb4c4.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1boX">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo_wide.svg" alt="Amido Stacks Logo" class="themedImage_3oOy themedImage--light_3ouy"><img src="/img/logo_wide.svg" alt="Amido Stacks Logo" class="themedImage_3oOy themedImage--dark_3zJb"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a href="https://github.com/amido/amido.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_2iFN toggle_2ySP toggleDisabled_1pbd"><div class="toggleTrack_1bVV" role="button" tabindex="-1"><div class="toggleTrackCheck_3GBG"><span class="toggleIcon_KBSf">ðŸŒœ</span></div><div class="toggleTrackX_1jae"><span class="toggleIcon_KBSf">ðŸŒž</span></div><div class="toggleTrackThumb_2_QT"></div></div><input type="checkbox" class="toggleScreenReader_32DE" aria-label="Switch between dark and light mode"></div><div class="searchBox_xXbB"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_3zOJ"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_DkI0" type="button"></button><aside class="docSidebarContainer_G8MK"><div class="sidebar_1tWv"><nav class="menu thin-scrollbar menu_1Iah"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Learn about Stacks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development Support</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Workloads</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/workloads">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Common</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Azure</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Frontend Web Applications</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Backend Services</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Java Spring Boot REST API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">.NET Core</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/introduction_netcore">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/requirements_netcore">Requirements</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Quickstart</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">REST API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">REST API with CQRS</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/create_project_netcore">Create REST API with CQRS project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/configure_project_netcore">Configure REST API with CQRS project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/build_and_run_project_netcore">Build &amp; Run REST API with CQRS</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/testing/functional_testing_netcore">Testing the API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/infrastructure_netcore">Infrastructure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/pipeline_netcore">Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/logging_netcore">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workloads/azure/backend/netcore/security_netcore">Security</a></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Google Cloud Platform</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Amazon Web Services</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Infrastructure</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quality Assurance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Stacks CLI</a></li></ul></nav></div></aside><main class="docMainContainer_3Zec"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col"><div class="docItemContainer_37q2"><article><div class="theme-doc-markdown markdown"><h2 class="anchor anchorWithStickyNavbar_1iPN" id="configuring-the-project">Configuring the project<a aria-hidden="true" class="hash-link" href="#configuring-the-project" title="Direct link to heading">â€‹</a></h2><p>All security sensitive information is passed as a secret in our configuration. We have a library called <a href="https://github.com/amido/stacks-dotnet-packages-configuration" target="_blank" rel="noopener noreferrer">Amido.Stacks.Configuration</a> that reads secrets from the environment before the application starts and makes the needed substitutions in the configuration files.</p><h3 class="anchor anchorWithStickyNavbar_1iPN" id="configuring-cosmos-db">Configuring Cosmos DB<a aria-hidden="true" class="hash-link" href="#configuring-cosmos-db" title="Direct link to heading">â€‹</a></h3><p>The project can be set to use Azure <strong>Cosmos DB</strong> or an <strong>InMemory</strong> database to store the example application data. The <strong>InMemory</strong> database works out of the box and no further setup is required aside from creating your project. Depending on your desired setup you&#x27;ll have to provide some or all of the configuration in the <code>appsettings.json</code> file section showed below.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">&lt;PROJECT-NAME&gt;/src/api/xxAMIDOxx.xxSTACKSxx.API/appsettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;CosmosDb&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;DatabaseAccountUri&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;Add CosmosDB Account URI here&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;DatabaseName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Stacks&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;SecurityKeySecret&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Identifier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;COSMOSDB_KEY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><br><details class="details_qFca alert alert--info details_14Wx" data-collapsed="true"><summary>Using the Cosmos DB Emulator to run the database locally</summary><div><div class="collapsibleContent_2fva"><div><p>For running on local environments (Windows/Linux/macOS) please follow the <a href="https://docs.microsoft.com/en-us/azure/cosmos-db/local-emulator?tabs=ssl-netstd21" target="_blank" rel="noopener noreferrer">instructions provided by Microsoft.</a></p><ol><li><p>Navigate to the local Cosmos DB URL in your browser as indicated in the documentation given in the above link.</p></li><li><p>Identify the <strong>Primary Key</strong>. Please refer to the field in the screenshot below. <img alt="CosmosDB" src="/assets/images/cosmosdb_emulator_3-ddb539bc14733fdf2bc3cb8dc022cf09.png"></p></li><li><p>Cosmos DB has to contain a fixed structure depending on your project. Create a collection <code>Stacks</code> (this corresponds to <code>DatabaseName</code> in the <code>appsettings.json</code> file) with a container id <code>Menu</code> (name of domain object) and the partition key <code>/id</code>. Keep in mind that if you&#x27;ve changed the domain (default being <code>Menu</code>), you have to supply your own domain when creating the container.</p></li></ol><p><img alt="CosmosDB" src="/assets/images/cosmosdb_emulator_1-eb5c6355a0662db45234724a920edac3.png"></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>CosmosDb environment variable</h5></div><div class="admonition-content"><p>To interact with CosmosDb there is a environment variable called <code>COSMOSDB_KEY</code> that needs to be set before running your application. This variable holds the value of the <strong>Primary Key</strong> you got from step 2. Please see the next section on details of how to set it on your machine.</p></div></div></div></div></div></details><br><details class="details_qFca alert alert--info details_14Wx" data-collapsed="true"><summary>Setting the COSMOSDB_KEY environment variable</summary><div><div class="collapsibleContent_2fva"><div><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_2kG2 tabs__item--active">Windows</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_2kG2">Unix</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>There are a couple of different ways to set the environment variable</p><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-powershell-for-cosmosdb_key">Using Powershell for COSMOSDB_KEY<a aria-hidden="true" class="hash-link" href="#using-powershell-for-cosmosdb_key" title="Direct link to heading">â€‹</a></h2><p>You can use <code>Powershell</code> with administrator privileges to execute the command below. Substitute <code>&lt;PRIMARY-KEY-HERE&gt;</code> with your own key.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">Run PS command to add the COSMOSDB_KEY system variable</div><div class="codeBlockContent_1izB powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">[Environment]::SetEnvironmentVariable(&quot;COSMOSDB_KEY&quot;, &quot;&lt;PRIMARY-KEY-HERE&gt;&quot;, [EnvironmentVariableTarget]::Machine)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-visual-studio-for-cosmosdb_key">Using Visual Studio for COSMOSDB_KEY<a aria-hidden="true" class="hash-link" href="#using-visual-studio-for-cosmosdb_key" title="Direct link to heading">â€‹</a></h2><ol><li><p>Open the project in Visual Studio. The solution file is located at <code>src/api/xxAMIDOxx.xxSTACKSxx.API.sln</code>.</p></li><li><p>Add <strong>COSMOSDB_KEY</strong> environment variable to the <strong>launchSettings.json</strong> file generated by Visual Studio and add the Cosmos DB Primary Key value.</p></li></ol><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">src/api/xxAMIDOxx.xxSTACKSxx.API/properties/launchSettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;profiles&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;xxAMIDOxx.xxSTACKSxx.API&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;environmentVariables&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;ASPNETCORE_ENVIRONMENT&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Development&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;COSMOSDB_KEY&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;PRIMARY-KEY-HERE&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-vscode-for-cosmosdb_key">Using VSCode for COSMOSDB_KEY<a aria-hidden="true" class="hash-link" href="#using-vscode-for-cosmosdb_key" title="Direct link to heading">â€‹</a></h2><p>If you&#x27;re using VSCode that means you&#x27;ll have a <code>launch.json</code> file generated when you try to run the project. In that file there&#x27;s an <code>env</code> section where you can put environment variables for the current session.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">launch.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;env&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;COSMOSDB_KEY&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;PRIMARY-KEY-HERE&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Note on usage</h5></div><div class="admonition-content"><p>The variable is referenced in <strong>appsettings.json</strong>. As mentioned in the beginning section of this page this environment variable name will be substituted with the actual value on startup.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">src/api/xxAMIDOxx.xxSTACKSxx.API/appsettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;CosmosDb&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;SecurityKeySecret&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Identifier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;COSMOSDB_KEY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div></div></div></div><div role="tabpanel" hidden=""><p>There are a couple of different ways to set the environment variable</p><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-terminal-for-cosmosdb_key">Using terminal for COSMOSDB_KEY<a aria-hidden="true" class="hash-link" href="#using-terminal-for-cosmosdb_key" title="Direct link to heading">â€‹</a></h2><p>You can use the <code>terminal</code> to execute the command below. Substitute <code>&lt;PRIMARY-KEY-HERE&gt;</code> with your own key. This will set the environment variable only for the current session of your terminal.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">Run terminal command to add the COSMOSDB_KEY system variable</div><div class="codeBlockContent_1izB shell"><pre tabindex="0" class="prism-code language-shell codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">COSMOSDB_KEY</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PRIMARY-KEY-HERE</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>To set the environment variable permanently on your system you&#x27;ll have to edit your <code>bash_profile</code> or <code>.zshenv</code> file depending on which shell are you using.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">Example for setting env variable in .zchenv</div><div class="codeBlockContent_1izB shell"><pre tabindex="0" class="prism-code language-shell codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;export COSMOSDB_KEY=&lt;PRIMARY-KEY-HERE&gt;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> ~/.zshenv</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-visual-studio-code-for-cosmosdb_key">Using Visual Studio Code for COSMOSDB_KEY<a aria-hidden="true" class="hash-link" href="#using-visual-studio-code-for-cosmosdb_key" title="Direct link to heading">â€‹</a></h2><p>If you&#x27;re using VSCode that means you&#x27;ll have a <code>launch.json</code> file generated when you try to run the project. In that file there&#x27;s an <code>env</code> section where you can put environment variables for the current session.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">launch.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;env&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;COSMOSDB_KEY&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;PRIMARY-KEY-HERE&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Note on usage</h5></div><div class="admonition-content"><p>The variable is referenced in <strong>appsettings.json</strong>. As mentioned in the beginning section of this page this environment variable name will be substituted with the actual value on startup.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">src/api/xxAMIDOxx.xxSTACKSxx.API/appsettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;CosmosDb&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;SecurityKeySecret&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Identifier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;COSMOSDB_KEY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div></div></div></div></div></div></div></div></div></details><br><details class="details_qFca alert alert--info details_14Wx" data-collapsed="true"><summary>Connecting to deployed Cosmos DB instance</summary><div><div class="collapsibleContent_2fva"><div>When choosing not to run the CosmosDB locally via the emulator, further configuration needs to be changed in the `appsettings.json` file.<p>Aside from setting the <code>COSMOSDB_KEY</code> as an environment variable (described in the previous section), you&#x27;ll have to set the CosmosDB URI parameter <code>DatabaseAccountUri</code> as well.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">&lt;PROJECT-NAME&gt;/src/api/xxAMIDOxx.xxSTACKSxx.API/appsettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;CosmosDb&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;DatabaseAccountUri&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;Add CosmosDB Account URI here&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;DatabaseName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Stacks&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;SecurityKeySecret&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Identifier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;COSMOSDB_KEY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div></div></div></div></details><br><h3 class="anchor anchorWithStickyNavbar_1iPN" id="configuring-dynamodb">Configuring DynamoDB<a aria-hidden="true" class="hash-link" href="#configuring-dynamodb" title="Direct link to heading">â€‹</a></h3><p>You need a DynamoDB instance in order to connect the API to it. You can follow the official instructions provided by AWS <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SettingUp.DynamoWebService.html" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Relevant documentation pages that you can follow to set up your profile:</p><ul><li><p><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html" target="_blank" rel="noopener noreferrer">Configuration and credential file settings</a></p></li><li><p><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html" target="_blank" rel="noopener noreferrer">Named profiles</a></p></li></ul><p>The template and NuGet package assumes you&#x27;ll use the <code>AWS CLI</code> tools and will have configured your access keys via the <code>aws configure</code> command.</p><p>Depending on your desired setup you&#x27;ll have to provide some or all of the configuration in the <code>appsettings.json</code> file section showed below.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">&lt;PROJECT-NAME&gt;/src/api/xxAMIDOxx.xxSTACKSxx.API/appsettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;DynamoDb&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;TableName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Menu&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;TablePrefix&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_1iPN" id="amidostacksdynamodb-package">Amido.Stacks.DynamoDB package<a aria-hidden="true" class="hash-link" href="#amidostacksdynamodb-package" title="Direct link to heading">â€‹</a></h3><p>This template uses the <a href="https://github.com/amido/stacks-dotnet-packages-dynamodb" target="_blank" rel="noopener noreferrer">Amido.Stacks.DynamoDB</a> package to connect and use DynamoDB.</p><br><h3 class="anchor anchorWithStickyNavbar_1iPN" id="configuring-aws-sns">Configuring AWS SNS<a aria-hidden="true" class="hash-link" href="#configuring-aws-sns" title="Direct link to heading">â€‹</a></h3><p>The project can be set to use AWS <strong>SNS</strong> to publish and consume events. In order to publish messages to a Queue you will also require a version of AWS SQS running on AWS cloud. For SNS to work out the box with AWS you will have to provide some configuration in the <code>appsettings.json</code> file section showed below as well as subscribeaing your SNS topic to your SQS queue.</p><p>You will also be required to set the <code>TOPIC_ARN</code> as an environment variable (see section <strong>Setting the TOPIC_ARN environment variable</strong>).</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">&lt;PROJECT-NAME&gt;/src/api/xxAMIDOxx.xxSTACKSxx.API/appsettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;AwsSnsConfiguration&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;TopicArn&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Identifier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TOPIC_ARN&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token property" style="color:#36acaa">&quot;AWS&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Region&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eu-west-2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><br><details class="details_qFca alert alert--info details_14Wx" data-collapsed="true"><summary>Using the AWS SNS to publish messages</summary><div><div class="collapsibleContent_2fva"><div><p>For running on local environments you will still require a version of AWS SNS running on AWS cloud.</p><ol><li><p>Navigate to the SNS Topic in your browser.</p></li><li><p>Identify the <strong>TopicArn</strong>. This is located within: Amazon SNS --&gt; Topics --&gt; topic-name (e.g. stacks-dev) --&gt; TopicArn</p></li><li><p>Apply the <strong>TopicArn</strong> obtained to the environmental variable called <code>TOPIC_ARN</code> (Please see the next section on details of how to set it on your machine).</p></li><li><p>Run your application and carry out some event worth actions (create domain objects, retrieve domain objects, delete domain objects etc...). Any time you carry out an action which should raise an event, there will be an event raised within your AWS SQS queue.</p></li><li><p>Navigate to the SQS Queue in your browser and select <code>Send and receive messages</code>. Select <code>Poll for messages</code> and see all the events raised.</p></li></ol></div></div></div></details><br><details class="details_qFca alert alert--info details_14Wx" data-collapsed="true"><summary>Setting the TOPIC_ARN environment variable</summary><div><div class="collapsibleContent_2fva"><div><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_2kG2 tabs__item--active">Windows</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_2kG2">Unix</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>There are a couple of different ways to set the environment variable</p><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-powershell-for-topic_arn">Using Powershell for TOPIC_ARN<a aria-hidden="true" class="hash-link" href="#using-powershell-for-topic_arn" title="Direct link to heading">â€‹</a></h2><p>You can use <code>Powershell</code> with administrator privileges to execute the command below. Substitute <code>&lt;TOPIC-ARN-HERE&gt;</code> with your own key.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">Run PS command to add the TOPIC_ARN system variable</div><div class="codeBlockContent_1izB powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token plain">[Environment]::SetEnvironmentVariable(&quot;TOPIC_ARN&quot;, &quot;&lt;TOPIC-ARN-HERE&gt;&quot;, [EnvironmentVariableTarget]::Machine)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-visual-studio-for-topic_arn">Using Visual Studio for TOPIC_ARN<a aria-hidden="true" class="hash-link" href="#using-visual-studio-for-topic_arn" title="Direct link to heading">â€‹</a></h2><ol><li><p>Open the project in Visual Studio. The solution file is located at <code>src/api/xxAMIDOxx.xxSTACKSxx.API.sln</code>.</p></li><li><p>Add <strong>TOPIC_ARN</strong> environment variable to the <strong>launchSettings.json</strong> file generated by Visual Studio and add the SNS topic ARN value.</p></li></ol><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">src/api/xxAMIDOxx.xxSTACKSxx.API/properties/launchSettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;profiles&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;xxAMIDOxx.xxSTACKSxx.API&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;environmentVariables&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;ASPNETCORE_ENVIRONMENT&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Development&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;TOPIC_ARN&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;TOPIC-ARN-HERE&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-vscode-for-topic_arn">Using VSCode for TOPIC_ARN<a aria-hidden="true" class="hash-link" href="#using-vscode-for-topic_arn" title="Direct link to heading">â€‹</a></h2><p>If you&#x27;re using VSCode that means you&#x27;ll have a <code>launch.json</code> file generated when you try to run the project. In that file there&#x27;s an <code>env</code> section where you can put environment variables for the current session.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">launch.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;env&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;TOPIC_ARN&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;TOPIC-ARN-HERE&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Note on usage</h5></div><div class="admonition-content"><p>The variable is referenced in <strong>appsettings.json</strong>. As mentioned in the beginning section of this page this environment variable name will be substituted with the actual value on startup.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">src/api/xxAMIDOxx.xxSTACKSxx.API/appsettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;AwsSnsConfiguration&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;TopicArn&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Identifier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TOPIC_ARN&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div></div></div></div><div role="tabpanel" hidden=""><p>There are a couple of different ways to set the environment variable</p><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-terminal-for-topic_arn">Using terminal for TOPIC_ARN<a aria-hidden="true" class="hash-link" href="#using-terminal-for-topic_arn" title="Direct link to heading">â€‹</a></h2><p>You can use the <code>terminal</code> to execute the command below. Substitute <code>&lt;TOPIC-ARN-HERE&gt;</code> with your own key. This will set the environment variable only for the current session of your terminal.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">Run terminal command to add the TOPIC_ARN system variable</div><div class="codeBlockContent_1izB shell"><pre tabindex="0" class="prism-code language-shell codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">TOPIC_ARN</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">TOPIC-ARN-HERE</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>To set the environment variable permanently on your system you&#x27;ll have to edit your <code>bash_profile</code> or <code>.zshenv</code> file depending on which shell are you using.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">Example for setting env variable in .zchenv</div><div class="codeBlockContent_1izB shell"><pre tabindex="0" class="prism-code language-shell codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;export TOPIC_ARN=&lt;TOPIC-ARN-HERE&gt;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> ~/.zshenv</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_1iPN" id="using-visual-studio-code-for-topic_arn">Using Visual Studio Code for TOPIC_ARN<a aria-hidden="true" class="hash-link" href="#using-visual-studio-code-for-topic_arn" title="Direct link to heading">â€‹</a></h2><p>If you&#x27;re using VSCode that means you&#x27;ll have a <code>launch.json</code> file generated when you try to run the project. In that file there&#x27;s an <code>env</code> section where you can put environment variables for the current session.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">launch.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;env&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;TOPIC_ARN&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;TOPIC-ARN-HERE&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Note on usage</h5></div><div class="admonition-content"><p>The variable is referenced in <strong>appsettings.json</strong>. As mentioned in the beginning section of this page this environment variable name will be substituted with the actual value on startup.</p><div class="codeBlockContainer_21wf"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_3oXa">src/api/xxAMIDOxx.xxSTACKSxx.API/appsettings.json</div><div class="codeBlockContent_1izB json"><pre tabindex="0" class="prism-code language-json codeBlock_1uaJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;AwsSnsConfiguration&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;TopicArn&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Identifier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TOPIC_ARN&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div></div></div></div></div></div></div></div></div></details></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/create_project_netcore"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Create REST API with CQRS project</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/workloads/azure/backend/netcore/quickstart/web_api_cqrs/build_and_run_project_netcore"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Build &amp; Run REST API with CQRS<!-- --> Â»</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs">Getting Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">About Us</div><ul class="footer__items"><li class="footer__item"><a href="https://amido.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Amido<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Open Source</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/amido/amido.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Amido Ltd</div></div></div></footer></div>
<script src="/assets/js/runtime~main.20fb541c.js"></script>
<script src="/assets/js/main.07ebb4c4.js"></script>
</body>
</html>